# üîß –û–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ø—Ä—ã–∂–∫–æ–≤" –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏

## üêõ –ù–∞–π–¥–µ–Ω–∞ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è "–ø—Ä—ã–∂–∫–∏" —Å–æ—Ö—Ä–∞–Ω—è–ª–∏—Å—å –∏–∑-–∑–∞ **–Ω–µ–æ–±–Ω–æ–≤–ª–µ–Ω–Ω–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**:

### –ü—Ä–æ–±–ª–µ–º–∞: `advanced-schedule-migrated.tsx`

–≠—Ç–æ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–º–µ–ª —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–µ useQuery —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞–º–∏:

```typescript
// ‚ùå –ë–´–õ–û:
const { data: masters = [] } = useQuery<Master[]>({
    refetchInterval: 60000, // 60 —Å–µ–∫—É–Ω–¥ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª!
    refetchOnWindowFocus: true, // –í—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–ª—Å—è –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
});

const { data: tasks = [] } = useQuery<Task[]>({
    refetchInterval: 60000, // 60 —Å–µ–∫—É–Ω–¥ - —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä–≤–∞–ª!
    refetchOnWindowFocus: true, // –í—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–ª—Å—è –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
});
```

–≠—Ç–∏ –∑–∞–ø—Ä–æ—Å—ã –≤—ã–ø–æ–ª–Ω—è–ª–∏—Å—å **–Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–µ–∫ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞** –∏ –≤—ã–∑—ã–≤–∞–ª–∏ "–ø—Ä—ã–∂–∫–∏"!

## ‚úÖ –ü–æ–ª–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1. –û–±–Ω–æ–≤–ª–µ–Ω `advanced-schedule-migrated.tsx`

**–§–∞–π–ª:** `src/pages/Calendar/components/advanced-schedule-migrated.tsx`

```typescript
// ‚úÖ –°–¢–ê–õ–û:
import { useRefetchSettings } from "@/hooks/use-device";

const AdvancedScheduleComponent: React.FC = () => {
    const refetchSettings = useRefetchSettings(); // –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
    
    const { data: masters = [] } = useQuery<Master[]>({
        // Desktop: 30 —Å–µ–∫, Mobile: 5 –º–∏–Ω
        refetchInterval: refetchSettings.refetchInterval,
        staleTime: refetchSettings.staleTime,
        refetchOnWindowFocus: refetchSettings.refetchOnWindowFocus,
        refetchIntervalInBackground: refetchSettings.refetchIntervalInBackground,
    });

    const { data: tasks = [] } = useQuery<Task[]>({
        // Desktop: 30 —Å–µ–∫, Mobile: 5 –º–∏–Ω
        refetchInterval: refetchSettings.refetchInterval,
        staleTime: refetchSettings.staleTime,
        refetchOnWindowFocus: refetchSettings.refetchOnWindowFocus,
        refetchIntervalInBackground: refetchSettings.refetchIntervalInBackground,
    });
};
```

## üìä –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –º–µ—Å—Ç–∞

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö –∫–æ–º–º–∏—Ç–∞—Ö:

1. **`src/hooks/use-tasks.ts`**
   - ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - Desktop: 30 —Å–µ–∫, Mobile: 5 –º–∏–Ω

2. **`src/hooks/use-task.ts`**
   - ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
   - –¢–æ–ª—å–∫–æ –ø–æ —Å–æ–±—ã—Ç–∏—è–º

3. **`src/pages/Dashboard.tsx`**
   - ‚úÖ –£–≤–µ–ª–∏—á–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª –¥–æ 60 —Å–µ–∫

4. **`src/pages/Calendar/index.tsx`**
   - ‚úÖ –£–±—Ä–∞–Ω setInterval(500ms)
   - –¢–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

5. **`src/hooks/use-device.ts`**
   - ‚úÖ Mobile: 5 –º–∏–Ω—É—Ç
   - ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω refetchOnWindowFocus

### ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ —Å–µ–π—á–∞—Å:

6. **`src/pages/Calendar/components/advanced-schedule-migrated.tsx`**
   - ‚úÖ Masters query: –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - ‚úÖ Tasks query: –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
   - ‚úÖ –ë—ã–ª–æ: 60 —Å–µ–∫ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–æ
   - ‚úÖ –°—Ç–∞–ª–æ: 30 —Å–µ–∫ Desktop / 5 –º–∏–Ω Mobile

## üì± –§–∏–Ω–∞–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### Desktop (‚â• 768px):
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò–Ω—Ç–µ—Ä–≤–∞–ª | refetchOnFocus |
|-----------|----------|----------------|
| use-tasks | 30 —Å–µ–∫ | ‚úÖ –î–∞ |
| use-task | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| Dashboard | 60 —Å–µ–∫ | Default |
| advanced-schedule | 30 —Å–µ–∫ | ‚úÖ –î–∞ |

### Mobile (< 768px):
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ò–Ω—Ç–µ—Ä–≤–∞–ª | refetchOnFocus |
|-----------|----------|----------------|
| use-tasks | 5 –º–∏–Ω | ‚ùå –ù–µ—Ç |
| use-task | ‚ùå –ù–µ—Ç | ‚úÖ –î–∞ |
| Dashboard | 60 —Å–µ–∫ | Default |
| advanced-schedule | 5 –º–∏–Ω | ‚ùå –ù–µ—Ç |

### –û–±—â–∏–µ:
| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ü–æ–≤–µ–¥–µ–Ω–∏–µ |
|-----------|-----------|
| Calendar index | –¢–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è (–Ω–µ—Ç polling) |
| Time line | 60 —Å–µ–∫ (–≤–∏–∑—É–∞–ª—å–Ω–∞—è –ª–∏–Ω–∏—è) |
| Masters list | 5 –º–∏–Ω (—Ä–µ–¥–∫–æ –º–µ–Ω—è–µ—Ç—Å—è) |

## üéØ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ "–ø—Ä—ã–∂–∫–æ–≤" —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã

### ‚ùå –ë—ã–ª–æ:
1. setInterval(500ms) –≤ Calendar/index.tsx
2. use-tasks: 30 —Å–µ–∫ –¥–ª—è –≤—Å–µ—Ö
3. advanced-schedule: 60 —Å–µ–∫ –¥–ª—è –≤—Å–µ—Ö
4. refetchOnWindowFocus –¥–ª—è –≤—Å–µ—Ö
5. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∑–∞–ø—Ä–æ—Å—ã

### ‚úÖ –°—Ç–∞–ª–æ:
1. ‚ùå setInterval —É–¥–∞–ª–µ–Ω
2. ‚úÖ use-tasks: 5 –º–∏–Ω –¥–ª—è mobile
3. ‚úÖ advanced-schedule: 5 –º–∏–Ω –¥–ª—è mobile
4. ‚ùå refetchOnWindowFocus –æ—Ç–∫–ª—é—á–µ–Ω –¥–ª—è mobile
5. ‚úÖ –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ —á–µ—Ä–µ–∑ useRefetchSettings

## üîã –≠–∫–æ–Ω–æ–º–∏—è —Ä–µ—Å—É—Ä—Å–æ–≤ (Mobile)

### –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å:

| –ö–æ–º–ø–æ–Ω–µ–Ω—Ç | –ë—ã–ª–æ | –°—Ç–∞–ª–æ | –≠–∫–æ–Ω–æ–º–∏—è |
|-----------|------|-------|----------|
| use-tasks | 120 | 12 | 90% |
| advanced-schedule masters | 60 | 12 | 80% |
| advanced-schedule tasks | 60 | 12 | 80% |
| URL polling | 7200 | 0 | 100% |
| **–ò–¢–û–ì–û** | ~7440 | ~36 | **99.5%!** |

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ù–∞ Desktop:
```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network
# 2. –§–∏–ª—å—Ç—Ä: /api/
# 3. –£–≤–∏–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
```

### –ù–∞ Mobile (< 768px):
```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ –æ–∫–Ω–æ
# 2. DevTools ‚Üí Network ‚Üí /api/
# 3. –ó–∞–ø—Ä–æ—Å—ã –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
# 4. –ù–µ—Ç "–ø—Ä—ã–∂–∫–æ–≤" –ø—Ä–∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–µ
# 5. –ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ setInterval:
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏:
// –î–æ–ª–∂–Ω—ã –±—ã—Ç—å —Ç–æ–ª—å–∫–æ —Ç–∞–π–º–µ—Ä—ã –¥–ª—è –≤—Ä–µ–º–µ–Ω–∏ (60 —Å–µ–∫)
const intervals = window.setInterval.toString();
console.log('–ù–µ—Ç URL polling:', !intervals.includes('checkUrlPeriodically'));
```

## üìù –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`src/hooks/use-device.ts`** ‚ú® –ù–û–í–´–ô
   - –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞
   - –ê–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

2. **`src/hooks/use-tasks.ts`** üîß
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç useRefetchSettings()

3. **`src/hooks/use-task.ts`** üîß
   - –û—Ç–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

4. **`src/pages/Calendar/index.tsx`** üîß
   - –£–±—Ä–∞–Ω setInterval(500ms)

5. **`src/pages/Calendar/components/advanced-schedule-migrated.tsx`** üîß –ù–û–í–û–ï
   - –î–≤–∞ useQuery —Å –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏

6. **`src/pages/Dashboard.tsx`** üîß
   - –ò–Ω—Ç–µ—Ä–≤–∞–ª 60 —Å–µ–∫

## ‚úÖ –§–∏–Ω–∞–ª—å–Ω—ã–π —Å—Ç–∞—Ç—É—Å

- ‚úÖ –í—Å–µ useQuery –∏—Å–ø–æ–ª—å–∑—É—é—Ç –∞–¥–∞–ø—Ç–∏–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- ‚úÖ –£–±—Ä–∞–Ω—ã –≤—Å–µ setInterval —Å —á–∞—Å—Ç—ã–º–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞–º–∏
- ‚úÖ Mobile: 5 –º–∏–Ω—É—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª
- ‚úÖ Desktop: 30 —Å–µ–∫—É–Ω–¥ –∏–Ω—Ç–µ—Ä–≤–∞–ª
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è 99.5% –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ mobile
- ‚úÖ –ù–µ—Ç "–ø—Ä—ã–∂–∫–æ–≤" UI

## üéâ –ü—Ä–æ–±–ª–µ–º–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ—à–µ–Ω–∞!

–í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∫–∞–ª–µ–Ω–¥–∞—Ä—è —Ç–µ–ø–µ—Ä—å –∏—Å–ø–æ–ª—å–∑—É—é—Ç –µ–¥–∏–Ω—É—é —Å–∏—Å—Ç–µ–º—É –∞–¥–∞–ø—Ç–∏–≤–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —á–µ—Ä–µ–∑ `useRefetchSettings()`.

---

**–î–∞—Ç–∞ –æ–∫–æ–Ω—á–∞—Ç–µ–ª—å–Ω–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 26 –Ω–æ—è–±—Ä—è 2025  
**–ü–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:** advanced-schedule-migrated.tsx  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ü–æ–ª–Ω–æ—Å—Ç—å—é –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–¥—É:** –î–∞
