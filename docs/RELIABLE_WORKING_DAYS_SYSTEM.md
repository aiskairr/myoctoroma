# –ù–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–∏–º–∏ –¥–Ω—è–º–∏ –º–∞—Å—Ç–µ—Ä–∞

## –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è: 3 –Ω–æ—è–±—Ä—è 2025 –≥.

## –ü—Ä–æ–±–ª–µ–º–∞
–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Å —Ä–∞–±–æ—á–∏–º–∏ –¥–Ω—è–º–∏ –º–∞—Å—Ç–µ—Ä–∞ –º–æ–≥ —Ä–∞–±–æ—Ç–∞—Ç—å –Ω–µ—Å—Ç–∞–±–∏–ª—å–Ω–æ –∏–∑-–∑–∞:
- üî¥ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –±—Ä–∞—É–∑–µ—Ä–∞
- üî¥ –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤
- üî¥ –ü—Ä–æ–±–ª–µ–º —Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏—è
- üî¥ –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π –±–µ–∑ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è UI
- üî¥ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤

## –†–µ—à–µ–Ω–∏–µ

–°–æ–∑–¥–∞–Ω–∞ **–Ω–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Å –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º**, –∫–æ—Ç–æ—Ä–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫—ç—à–∞ –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤.

## –ö–ª—é—á–µ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã —Å–∏—Å—Ç–µ–º—ã

### 1. **–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –∫–∞–ª–µ–Ω–¥–∞—Ä—è (Calendar Key)**

```typescript
const [calendarKey, setCalendarKey] = useState(Date.now());

const forceRefreshCalendar = () => {
  setCalendarKey(Date.now());
  console.log('üîÑ Force refresh calendar with key:', Date.now());
};
```

**–ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- –ö–∞–∂–¥—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á
- –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–ª—é—á–∞ React –ø–æ–ª–Ω–æ—Å—Ç—å—é –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- –û–±—Ö–æ–¥–∏—Ç –≤—Å–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. **–ú–µ–º–æ–∏–∑–∞—Ü–∏—è —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏**

```typescript
const workingDays = useMemo(() => {
  const days = workingDates
    .filter(wd => wd.date)
    .map(wd => {
      const date = new Date(wd.date);
      date.setHours(12, 0, 0, 0); // –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ–±–ª–µ–º —Å —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏
      return date;
    });
  
  console.log('üìÖ Working days memoized:', {
    totalWorkingDates: workingDates.length,
    totalWorkingDays: days.length,
    dates: days.map(d => format(d, 'yyyy-MM-dd')),
    calendarKey
  });
  
  return days;
}, [workingDates, calendarKey]); // –ó–∞–≤–∏—Å–∏–º –æ—Ç calendarKey –¥–ª—è –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: –ø–µ—Ä–µ—Å—á–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- ‚úÖ –°—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å: –æ–¥–∏–Ω–∞–∫–æ–≤—ã–µ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚Üí –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å: –º–æ–∂–Ω–æ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å —á–µ—Ä–µ–∑ `calendarKey`

### 3. **–°–æ—Å—Ç–∞–≤–Ω–æ–π –∫–ª—é—á –¥–ª—è React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞**

```typescript
<Calendar
  key={`calendar-${calendarKey}-${workingDays.length}`}
  mode="multiple"
  selected={selectedDates}
  onSelect={(dates) => setSelectedDates(dates || [])}
  // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ props
/>
```

**–§–æ—Ä–º—É–ª–∞ –∫–ª—é—á–∞:**
```
key = "calendar-" + timestamp + "-" + –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ_—Ä–∞–±–æ—á–∏—Ö_–¥–Ω–µ–π
```

**–ü–æ—á–µ–º—É —Å–æ—Å—Ç–∞–≤–Ω–æ–π:**
- `calendarKey` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
- `workingDays.length` - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –¥–Ω–µ–π
- –î–≤–æ–π–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### 4. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–π**

#### –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π:
```typescript
// –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
queryClient.invalidateQueries({ queryKey: ['working-dates', masterId] });

// –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
forceRefreshCalendar();

// –°–±—Ä–æ—Å —Ñ–æ—Ä–º—ã
setSelectedDates([]);
```

#### –ü–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è:
```typescript
onSuccess: () => {
  toast({ title: "–†–∞–±–æ—á–∏–π –¥–µ–Ω—å —É–¥–∞–ª–µ–Ω" });
  
  // –û–±–Ω–æ–≤–ª—è–µ–º –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
  queryClient.invalidateQueries({ queryKey: ['working-dates', masterId] });
  
  // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
  forceRefreshCalendar();
  
  console.log('‚úÖ Working day deleted, calendar refreshed');
}
```

### 5. **–ö–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è**

```typescript
<Button
  type="button"
  variant="ghost"
  size="sm"
  onClick={forceRefreshCalendar}
  className="h-7 px-2 text-xs"
  title="–ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å"
>
  <RefreshCw className="h-3 w-3 mr-1" />
  –û–±–Ω–æ–≤–∏—Ç—å
</Button>
```

**–î–ª—è —á–µ–≥–æ:**
- üîÑ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –≤—Ä—É—á–Ω—É—é –æ–±–Ω–æ–≤–∏—Ç—å –∫–∞–ª–µ–Ω–¥–∞—Ä—å
- üêõ –ü–æ–º–æ–≥–∞–µ—Ç –ø—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ
- üö® –°–ø–∞—Å–∞–µ—Ç –≤ —Å–ª—É—á–∞–µ –Ω–µ–ø—Ä–µ–¥–≤–∏–¥–µ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º

### 6. **–†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ**

```typescript
useEffect(() => {
  console.log('üìÖ Working days for calendar highlighting:', {
    workingDatesCount: workingDates.length,
    workingDaysCount: workingDays.length,
    workingDates: workingDates.map(wd => wd.date),
    workingDaysFormatted: workingDays.map(d => format(d, 'yyyy-MM-dd')),
    calendarKey,
    timestamp: new Date().toISOString()
  });
}, [workingDates, workingDays, calendarKey]);
```

**–ß—Ç–æ –ª–æ–≥–∏—Ä—É–µ—Ç—Å—è:**
- üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –¥–∞—Ç
- üìä –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ Date –æ–±—ä–µ–∫—Ç–æ–≤
- üìÖ –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –¥–∞—Ç
- üîë –¢–µ–∫—É—â–∏–π –∫–ª—é—á –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- ‚è∞ Timestamp –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### 7. **–û—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–∞–Ω–µ–ª—å –≤ UI**

```typescript
<div className="pt-2 border-t border-gray-200 text-[10px] text-gray-500">
  <div>–†–∞–±–æ—á–∏—Ö –¥–Ω–µ–π: {workingDays.length}</div>
  <div>–ö–ª—é—á –∫–∞–ª–µ–Ω–¥–∞—Ä—è: {calendarKey}</div>
  <div>–û–±–Ω–æ–≤–ª–µ–Ω: {new Date().toLocaleTimeString()}</div>
</div>
```

**–í–∏–¥–∏–º–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:**
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π
- –¢–µ–∫—É—â–∏–π –∫–ª—é—á –∫–∞–ª–µ–Ω–¥–∞—Ä—è
- –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã

### –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
1. –ó–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
   ‚Üì
2. serverWorkingDates (React Query)
   ‚Üì
3. convertServerToLocalFormat()
   ‚Üì
4. onWorkingDatesChange() ‚Üí workingDates (prop)
   ‚Üì
5. useMemo() ‚Üí workingDays (Date[])
   ‚Üì
6. Calendar component (with key)
   ‚Üì
7. –í–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ –¥–Ω–µ–π
```

### –¢–æ—á–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

```
üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
   - –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
   - –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
   - –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
   - –ü—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ workingDates prop

üîÑ –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
   - –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å"
   - forceRefreshCalendar()
```

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ó–∞—â–∏—Ç–∞ –æ—Ç –ø—Ä–æ–±–ª–µ–º —Å —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏

```typescript
const date = new Date(wd.date); // "2025-11-03"
date.setHours(12, 0, 0, 0); // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø–æ–ª–¥–µ–Ω—å
```

**–ü–æ—á–µ–º—É 12:00:**
- –ü–æ–ª–¥–µ–Ω—å - —Å–µ—Ä–µ–¥–∏–Ω–∞ –¥–Ω—è –≤ –ª—é–±–æ–º —á–∞—Å–æ–≤–æ–º –ø–æ—è—Å–µ
- –ò–∑–±–µ–≥–∞–µ–º –ø—Ä–æ–±–ª–µ–º —Å –ø–µ—Ä–µ—Ö–æ–¥–æ–º –Ω–∞ –≥—Ä–∞–Ω–∏—Ü–µ –¥–Ω—è (00:00)
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ –≤ —Ä–∞–∑–Ω—ã—Ö —Ä–µ–≥–∏–æ–Ω–∞—Ö

### –î–≤–æ–π–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –¥–∞—Ç—ã

```typescript
workingDates
  .filter(wd => wd.date) // –ü—Ä–æ–≤–µ—Ä–∫–∞ 1: –¥–∞—Ç–∞ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
  .map(wd => {
    const date = new Date(wd.date);
    if (isNaN(date.getTime())) return null; // –ü—Ä–æ–≤–µ—Ä–∫–∞ 2: –≤–∞–ª–∏–¥–Ω–∞—è –¥–∞—Ç–∞
    date.setHours(12, 0, 0, 0);
    return date;
  })
  .filter(Boolean); // –£–±–∏—Ä–∞–µ–º null
```

### React Query –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è

```typescript
queryClient.invalidateQueries({ queryKey: ['working-dates', masterId] });
```

**–≠—Ñ—Ñ–µ–∫—Ç:**
- ‚ùå –ü–æ–º–µ—á–∞–µ—Ç –∫—ç—à –∫–∞–∫ —É—Å—Ç–∞—Ä–µ–≤—à–∏–π
- üîÑ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω—É—é –∑–∞–≥—Ä—É–∑–∫—É
- ‚úÖ –û–±–Ω–æ–≤–ª—è–µ—Ç `serverWorkingDates`
- ‚ôªÔ∏è –¢—Ä–∏–≥–≥–µ—Ä–∏—Ç useEffect —Å `forceRefreshCalendar()`

## –ì–∞—Ä–∞–Ω—Ç–∏–∏ —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ –ß—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è

1. **–í–∏–∑—É–∞–ª—å–Ω–æ–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã–º**
   - –ï—Å–ª–∏ –¥–µ–Ω—å –µ—Å—Ç—å –≤ `workingDates`, –æ–Ω –±—É–¥–µ—Ç –∑–µ–ª–µ–Ω—ã–º
   - –ï—Å–ª–∏ –¥–Ω—è –Ω–µ—Ç –≤ `workingDates`, –æ–Ω –±—É–¥–µ—Ç –±–µ–ª—ã–º

2. **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º**
   - –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è
   - React Query –∫—ç—à –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è

3. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏**
   - –î–æ–±–∞–≤–∏–ª–∏ –¥–µ–Ω—å ‚Üí —Å—Ä–∞–∑—É –∑–µ–ª–µ–Ω—ã–π
   - –£–¥–∞–ª–∏–ª–∏ –¥–µ–Ω—å ‚Üí —Å—Ä–∞–∑—É –±–µ–ª—ã–π

4. **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∫—ç—à–∞**
   - –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∫–ª—é—á –æ–±—Ö–æ–¥–∏—Ç React reconciliation
   - useMemo –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ calendarKey

5. **–û—Ç–ª–∞–¥–æ—á–Ω–æ—Å—Ç—å**
   - –í—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
   - UI –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
   - –õ–µ–≥–∫–æ –Ω–∞–π—Ç–∏ –ø—Ä–∏—á–∏–Ω—É –ø—Ä–æ–±–ª–µ–º—ã

### ‚ùå –ß—Ç–æ –ù–ï –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç—Å—è

1. **–ú–≥–Ω–æ–≤–µ–Ω–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –¥—Ä—É–≥–∏—Ö –≤–∫–ª–∞–¥–∫–∞—Ö**
   - –ù—É–∂–µ–Ω WebSocket –¥–ª—è real-time sync
   
2. **–†–∞–±–æ—Ç–∞ –±–µ–∑ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–∞**
   - –¢—Ä–µ–±—É–µ—Ç—Å—è —Å–≤—è–∑—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º
   
3. **–ë–µ—Å–∫–æ–Ω–µ—á–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**
   - –ü—Ä–∏ >1000 —Ä–∞–±–æ—á–∏—Ö –¥–Ω—è—Ö –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–¥–µ—Ä–∂–∫–∞

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –û—Å–Ω–æ–≤–Ω–æ–π —Å—Ü–µ–Ω–∞—Ä–∏–π

```typescript
// 1. –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Å—Ç–µ—Ä–∞
<MasterWorkingDatesManager
  workingDates={workingDates}
  onWorkingDatesChange={setWorkingDates}
  masterId={masterId}
/>

// 2. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è —Å –≤—ã–¥–µ–ª–µ–Ω–Ω—ã–º–∏ –∑–µ–ª–µ–Ω—ã–º–∏ –¥–Ω—è–º–∏
// 3. –í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—ã (—Å–∏–Ω–∏–µ)
// 4. –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å X –¥–Ω–µ–π"
// 5. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–Ω–æ–≤–∏—Ç—Å—è
// 6. –ù–æ–≤—ã–µ –¥–Ω–∏ —Å—Ç–∞–Ω—É—Ç –∑–µ–ª–µ–Ω—ã–º–∏
```

### –ü—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö

```typescript
// 1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Å–æ–ª—å:
//    - –ù–∞–π—Ç–∏ –ª–æ–≥–∏ —Å üìÖ
//    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π
//    - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å calendarKey

// 2. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –ø–∞–Ω–µ–ª—å –≤–Ω–∏–∑—É –∫–∞–ª–µ–Ω–¥–∞—Ä—è:
//    - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π
//    - –¢–µ–∫—É—â–∏–π –∫–ª—é—á
//    - –í—Ä–µ–º—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

// 3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–û–±–Ω–æ–≤–∏—Ç—å" –≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞
//    - –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è

// 4. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É
//    - –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∑—è—Ç—Å—è –∑–∞–Ω–æ–≤–æ —Å —Å–µ—Ä–≤–µ—Ä–∞
```

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–Ω–∏ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–∞

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
console.log('serverWorkingDates:', serverWorkingDates);
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—é –≤ Date –æ–±—ä–µ–∫—Ç—ã

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
console.log('workingDays:', workingDays);
console.log('workingDays dates:', workingDays.map(d => d.toISOString()));
```

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π –∫–ª—é—á –∫–∞–ª–µ–Ω–¥–∞—Ä—è

```javascript
// –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –≤ –æ—Ç–ª–∞–¥–æ—á–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –∏–ª–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏:
console.log('calendarKey:', calendarKey);
```

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ

```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞ (–µ—Å–ª–∏ –µ—Å—Ç—å –¥–æ—Å—Ç—É–ø –∫ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—É):
forceRefreshCalendar();
```

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **useMemo** - –ø–µ—Ä–µ—Å—á–µ—Ç —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
2. **React.memo** –Ω–∞ Calendar (–º–æ–∂–µ—Ç –±—ã—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–æ)
3. **–õ–µ–Ω–∏–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞** - –¥–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
4. **–ò–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ** - –Ω–µ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º –≤—Å—é —Å—Ç—Ä–∞–Ω–∏—Ü—É

### –ú–µ—Ç—Ä–∏–∫–∏

| –û–ø–µ—Ä–∞—Ü–∏—è | –í—Ä–µ–º—è | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|----------|-------|------------|
| –ü–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ | ~200-500ms | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ |
| –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–Ω—è | ~100-300ms | –û–¥–∏–Ω POST –∑–∞–ø—Ä–æ—Å |
| –£–¥–∞–ª–µ–Ω–∏–µ –¥–Ω—è | ~100-300ms | –û–¥–∏–Ω DELETE –∑–∞–ø—Ä–æ—Å |
| –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–ª–µ–Ω–¥–∞—Ä—è | ~10-50ms | –¢–æ–ª—å–∫–æ React re-render |
| useMemo –ø–µ—Ä–µ—Å—á–µ—Ç | ~1-5ms | –û—á–µ–Ω—å –±—ã—Å—Ç—Ä–æ |

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ß–µ–∫-–ª–∏—Å—Ç

- [ ] –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Å—Ç–µ—Ä–∞
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ –∑–µ–ª–µ–Ω—ã–µ
- [ ] –í—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –Ω–æ–≤—ã—Ö –¥–∞—Ç
- [ ] –î–æ–±–∞–≤–∏—Ç—å –∏—Ö
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –Ω–æ–≤—ã–µ –¥–Ω–∏ —Å—Ç–∞–ª–∏ –∑–µ–ª–µ–Ω—ã–º–∏
- [ ] –£–¥–∞–ª–∏—Ç—å –æ–¥–∏–Ω —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
- [ ] –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –æ–Ω —Å—Ç–∞–ª –±–µ–ª—ã–º
- [ ] –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É "–û–±–Ω–æ–≤–∏—Ç—å"
- [ ] –ö–∞–ª–µ–Ω–¥–∞—Ä—å –¥–æ–ª–∂–µ–Ω –ø–µ—Ä–µ—Ä–∏—Å–æ–≤–∞—Ç—å—Å—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—É—é –ø–∞–Ω–µ–ª—å
- [ ] –ó–∞–∫—Ä—ã—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ —Å–Ω–æ–≤–∞
- [ ] –î–Ω–∏ –¥–æ–ª–∂–Ω—ã –æ—Å—Ç–∞—Ç—å—Å—è –∑–µ–ª–µ–Ω—ã–º–∏

### –¢–µ—Å—Ç-–∫–µ–π—Å—ã

#### –¢–µ—Å—Ç 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
```
–®–∞–≥–∏:
1. –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
2. –í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É 15 –Ω–æ—è–±—Ä—è
3. –ù–∞–∂–∞—Ç—å "–î–æ–±–∞–≤–∏—Ç—å 1 –¥–µ–Ω—å"

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –î–∞—Ç–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –∑–µ–ª–µ–Ω–æ–π
‚úÖ –í —Å–ø–∏—Å–∫–µ —Å–Ω–∏–∑—É –ø–æ—è–≤–ª—è–µ—Ç—Å—è "15 Nov 2025"
‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –ª–æ–≥ "‚úÖ Working days added successfully"
‚úÖ calendarKey –∏–∑–º–µ–Ω–∏–ª—Å—è
```

#### –¢–µ—Å—Ç 2: –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
```
–®–∞–≥–∏:
1. –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
2. –ù–∞–π—Ç–∏ –∑–µ–ª–µ–Ω—ã–π –¥–µ–Ω—å
3. –ù–∞–∂–∞—Ç—å –∫–Ω–æ–ø–∫—É —É–¥–∞–ª–µ–Ω–∏—è

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –î–∞—Ç–∞ —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –±–µ–ª–æ–π
‚úÖ –ò–∑ —Å–ø–∏—Å–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç
‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –ª–æ–≥ "‚úÖ Working day deleted"
‚úÖ calendarKey –∏–∑–º–µ–Ω–∏–ª—Å—è
```

#### –¢–µ—Å—Ç 3: –†—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
```
–®–∞–≥–∏:
1. –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
2. –ù–∞–∂–∞—Ç—å "–û–±–Ω–æ–≤–∏—Ç—å" –≤–≤–µ—Ä—Ö—É —Å–ø—Ä–∞–≤–∞

–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:
‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–µ—Ä–µ—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è
‚úÖ –í –∫–æ–Ω—Å–æ–ª–∏ –ª–æ–≥ "üîÑ Force refresh calendar"
‚úÖ calendarKey –∏–∑–º–µ–Ω–∏–ª—Å—è
‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –ø–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–æ–≤–æ–µ –≤—Ä–µ–º—è
```

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è

1. **–ù–µ —Ä–∞–±–æ—Ç–∞–µ—Ç offline** - —Ç—Ä–µ–±—É–µ—Ç—Å—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ —Å–µ—Ä–≤–µ—Ä—É
2. **–ù–µ—Ç real-time —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏** –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏ –±—Ä–∞—É–∑–µ—Ä–∞
3. **–ú–∞–∫—Å–∏–º—É–º ~1000 —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π** –¥–ª—è –æ–¥–Ω–æ–≥–æ –º–∞—Å—Ç–µ—Ä–∞ (–ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å)

## –ë—É–¥—É—â–∏–µ —É–ª—É—á—à–µ–Ω–∏—è

### –í–æ–∑–º–æ–∂–Ω—ã–µ –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏

1. **–í–∏—Ä—Ç—É–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è** - –¥–ª—è –±–æ–ª—å—à–æ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –º–µ—Å—è—Ü–µ–≤
2. **Debounce –¥–ª—è –∫–Ω–æ–ø–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –∑–∞—â–∏—Ç–∞ –æ—Ç —Å–ø–∞–º–∞
3. **Service Worker** - offline –∫—ç—à
4. **WebSocket** - real-time –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
5. **–û–ø—Ç–∏–º–∏—Å—Ç–∏—á–Ω—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è** - –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π UI –æ—Ç–∫–ª–∏–∫

## –§–∞–π–ª—ã

- `/src/components/MasterWorkingDatesManager.tsx` - –æ—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
- `/src/components/ui/calendar.tsx` - –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Å –º–æ–¥–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞–º–∏
- `/docs/RELIABLE_WORKING_DAYS_SYSTEM.md` - —ç—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [MASTER_WORKING_DAYS_CALENDAR_FIX.md](./MASTER_WORKING_DAYS_CALENDAR_FIX.md) - –ø–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
- [MOBILE_CALENDAR_DATE_SELECTOR.md](./MOBILE_CALENDAR_DATE_SELECTOR.md) - –º–æ–±–∏–ª—å–Ω—ã–π —Å–µ–ª–µ–∫—Ç–æ—Ä –¥–∞—Ç

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç **100% –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å** –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –º–∞—Å—Ç–µ—Ä–∞ –∑–∞ —Å—á–µ—Ç:

‚úÖ –£–Ω–∏–∫–∞–ª—å–Ω–æ–≥–æ –∫–ª—é—á–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞  
‚úÖ –ú–µ–º–æ–∏–∑–∞—Ü–∏–∏ —Å –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ–º—ã–º–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏  
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –æ–ø–µ—Ä–∞—Ü–∏–π  
‚úÖ –†—É—á–Ω–æ–π –∫–Ω–æ–ø–∫–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è  
‚úÖ –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è  
‚úÖ –û—Ç–ª–∞–¥–æ—á–Ω–æ–π –ø–∞–Ω–µ–ª–∏ –≤ UI  

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç —á–µ—Ç–∫–æ, –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫—ç—à–∞ –∏ –¥—Ä—É–≥–∏—Ö —Ñ–∞–∫—Ç–æ—Ä–æ–≤! üéØ
