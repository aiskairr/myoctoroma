# Fix: –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤

## –î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
20 –æ–∫—Ç—è–±—Ä—è 2025 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ v2)

## –ü—Ä–æ–±–ª–µ–º–∞ —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º —Ä–µ—à–µ–Ω–∏–µ–º

–ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–æ–∑–Ω–∏–∫–ª–∞ –Ω–æ–≤–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞**: –°—Ç—Ä–∞–Ω–∏—Ü–∞ `/master/calendar` –ø—Ä–æ—Å—Ç–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–ª–∞ `/crm/calendar`
2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π API**: –û–±–∞ —Ä–æ—É—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ API –¥–ª—è —Ñ–∏–ª–∏–∞–ª–∞
3. **–î–æ—Å—Ç—É–ø –Ω–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω**: –ú–∞—Å—Ç–µ—Ä–∞ –º–æ–≥–ª–∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ `/crm/calendar` –∏ –≤–∏–¥–µ—Ç—å –≤—Å–µ—Ö –º–∞—Å—Ç–µ—Ä–æ–≤ —Ñ–∏–ª–∏–∞–ª–∞

## –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

### 1. –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `/crm/calendar`

**–§–∞–π–ª: `src/pages/Calendar/components/time-schedule.tsx`**

–£–¥–∞–ª–µ–Ω—ã –≤—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ `user?.role === 'master'`:
- ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–æ–≤ –ø–æ —Ä–æ–ª–∏ - —É–¥–∞–ª–µ–Ω–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ `handleMouseDown` - —É–¥–∞–ª–µ–Ω–∞  
- ‚úÖ –£—Å–ª–æ–≤–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è - —É–¥–∞–ª–µ–Ω—ã
- ‚úÖ –õ–æ–≥–∏–∫–∞ `isWorking` –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤ - —É–¥–∞–ª–µ–Ω–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: `/crm/calendar` —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ –∏ —Ä–∞–Ω—å—à–µ –¥–ª—è –≤—Å–µ—Ö —Ä–æ–ª–µ–π –∫—Ä–æ–º–µ master.

### 2. –°–æ–∑–¥–∞–Ω –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤

**–§–∞–π–ª: `src/pages/Calendar/MasterCalendarView.tsx`**

–°–æ–∑–¥–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç, –∫–æ—Ç–æ—Ä—ã–π:

```typescript
// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π API –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤
const { data: tasks = [] } = useQuery<MasterTask[]>({
    queryKey: ['master-calendar-tasks', user.master_id, dateString],
    queryFn: async () => {
        const params = new URLSearchParams({
            masterId: user.master_id?.toString() || '',
            date: dateString
        });

        const response = await fetch(
            `${import.meta.env.VITE_BACKEND_URL}/api/crm/tasks-master-calendar?${params}`,
            { credentials: 'include' }
        );
        
        return response.json();
    },
    enabled: !!user.master_id,
});
```

**–ö–ª—é—á–µ–≤—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç API `/api/crm/tasks-master-calendar` —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `masterId` –∏ `date`
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–æ–ª—å: —Ç–æ–ª—å–∫–æ –¥–ª—è `master`
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏ —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Å—Ç–µ—Ä–∞
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (—Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á, –∞ –Ω–µ —Å–µ—Ç–∫–∞)
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–Ω—è
- ‚úÖ –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º

### 3. –û–±–Ω–æ–≤–ª–µ–Ω—ã —Ä–æ—É—Ç—ã

**–§–∞–π–ª: `src/App.tsx`**

```typescript
// –î–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤ - –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
<Route path="/master/calendar">
  <ProtectedLayout>
    <MasterCalendarView />
  </ProtectedLayout>
</Route>

// –î–ª—è –∞–¥–º–∏–Ω–æ–≤ - –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å
<Route path="/crm/calendar">
  <ProtectedLayout>
    <CalendarScreen />
  </ProtectedLayout>
</Route>
```

### 4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω –¥–æ—Å—Ç—É–ø –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤

**–§–∞–π–ª: `src/components/SimpleProtectedRoute.tsx`**

```typescript
// –î–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –¥–æ—Å—Ç—É–ø
if (user?.role === 'master') {
    const currentPath = window.location.pathname;
    const allowedPaths = ['/master/calendar', '/settings']; // /crm/calendar —É–¥–∞–ª–µ–Ω!
    
    if (!allowedPaths.includes(currentPath)) {
        window.location.href = "/master/calendar";
        // ...
    }
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ú–∞—Å—Ç–µ—Ä–∞ –±–æ–ª—å—à–µ –Ω–µ –º–æ–≥—É—Ç –ø–æ–ø–∞—Å—Ç—å –Ω–∞ `/crm/calendar`.

## API –≠–Ω–¥–ø–æ–∏–Ω—Ç

### GET `/api/crm/tasks-master-calendar`

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `masterId` (required) - ID –º–∞—Å—Ç–µ—Ä–∞
- `date` (optional) - –î–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD

**–û—Ç–≤–µ—Ç:**
```json
[
  {
    "id": 0,
    "title": "string",
    "date": "2025-10-17",
    "time": "string",
    "master_name": "string",
    "client_name": "string",
    "service_name": "string",
    "status": "string",
    "duration": 60,
    "price": 1500,
    "notes": "string",
    "start_time": "10:00",
    "end_time": "11:00",
    "paid": "paid"
  }
]
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   User Role: master     ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
      /master/calendar
             ‚îÇ
             ‚îú‚îÄ‚ñ∫ MasterCalendarView.tsx
             ‚îÇ   (–æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)
             ‚îÇ
             ‚îú‚îÄ‚ñ∫ API: /api/crm/tasks-master-calendar
             ‚îÇ   –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: masterId, date
             ‚îÇ
             ‚îú‚îÄ‚ñ∫ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç: —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏ –º–∞—Å—Ç–µ—Ä–∞
             ‚îú‚îÄ‚ñ∫ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á + —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
             ‚îî‚îÄ‚ñ∫ –î–æ—Å—Ç—É–ø: –¢–û–õ–¨–ö–û –¥–ª—è master

      ‚ùå /crm/calendar
             ‚îÇ
             ‚îî‚îÄ‚ñ∫ –î–û–°–¢–£–ü –ó–ê–ü–†–ï–©–ï–ù –¥–ª—è master


‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ User Role: admin/super  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
             ‚îÇ
             ‚ñº
      /crm/calendar
             ‚îÇ
             ‚îú‚îÄ‚ñ∫ CalendarScreen (time-schedule.tsx)
             ‚îÇ   (–ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å)
             ‚îÇ
             ‚îú‚îÄ‚ñ∫ API: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
             ‚îÇ   /api/masters, /api/crm/tasks, etc.
             ‚îÇ
             ‚îú‚îÄ‚ñ∫ –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç: –≤—Å–µ –º–∞—Å—Ç–µ—Ä–∞ —Ñ–∏–ª–∏–∞–ª–∞
             ‚îú‚îÄ‚ñ∫ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: —Å–µ—Ç–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è
             ‚îú‚îÄ‚ñ∫ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ: drag&drop, –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ
             ‚îî‚îÄ‚ñ∫ –î–æ—Å—Ç—É–ø: admin, superadmin, reception

      ‚ùå /master/calendar
             ‚îÇ
             ‚îî‚îÄ‚ñ∫ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /crm/calendar
```

## –ß—Ç–æ –∏–∑–º–µ–Ω–∏–ª–æ—Å—å

### –î–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/master/calendar` (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π —Ä–æ—É—Ç)
- ‚úÖ API: `/api/crm/tasks-master-calendar?masterId=X&date=Y`
- ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á (–Ω–µ —Å–µ—Ç–∫–∞)
- ‚úÖ –î–æ—Å—Ç—É–ø –¢–û–õ–¨–ö–û –∫ —Å–≤–æ–∏–º –∑–∞–¥–∞—á–∞–º
- ‚ùå `/crm/calendar` –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `/crm/calendar` (–∫–∞–∫ —Ä–∞–Ω—å—à–µ)
- ‚úÖ API: —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã
- ‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å: —Å–µ—Ç–∫–∞ –∫–∞–ª–µ–Ω–¥–∞—Ä—è (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
- ‚úÖ –ü–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ñ–∏–ª–∏–∞–ª–æ–º
- ‚ùå –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ—Ç –ø—Ä–µ–¥—ã–¥—É—â–µ–π –≤–µ—Ä—Å–∏–∏

## –û—Ç–∫–∞—á–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

–ò–∑ `time-schedule.tsx` —É–¥–∞–ª–µ–Ω—ã:

1. **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –º–∞—Å—Ç–µ—Ä–æ–≤ –ø–æ —Ä–æ–ª–∏** (—Å—Ç—Ä–æ–∫–∏ 291-294):
```typescript
// –£–î–ê–õ–ï–ù–û
if (user?.role === 'master' && user?.master_id) {
    filteredMasters = mastersData.filter(master => master.id === user.master_id);
}
```

2. **–£—Å–ª–æ–≤–∏–µ isWorking –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤** (—Å—Ç—Ä–æ–∫–∞ 316):
```typescript
// –£–î–ê–õ–ï–ù–û
const isWorking = user?.role === 'master' ? true : !!workingDate;

// –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–û
const isWorking = !!workingDate;
```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ handleMouseDown** (—Å—Ç—Ä–æ–∫–∏ 853-856):
```typescript
// –£–î–ê–õ–ï–ù–û
if (user?.role === 'master' && user?.master_id && appointment.employeeId !== user.master_id.toString()) {
    console.log('üö´ Master cannot drag appointments of other masters');
    return;
}
```

4. **–£—Å–ª–æ–≤–∏—è –¥–ª—è –∫–Ω–æ–ø–æ–∫** (—Å—Ç—Ä–æ–∫–∏ 1644, 1907):
```typescript
// –£–î–ê–õ–ï–ù–û
{user?.role !== 'master' && (
    <button>...</button>
)}

// –í–û–°–°–¢–ê–ù–û–í–õ–ï–ù–û
<button>...</button>
```

## –ù–æ–≤—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç MasterCalendarView

### –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:

1. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–∏**
```typescript
if (!user || user.role !== 'master') {
    return <AccessDenied />;
}
```

2. **–ó–∞–≥—Ä—É–∑–∫–∞ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π API**
```typescript
const { data: tasks } = useQuery({
    queryFn: async () => {
        const params = new URLSearchParams({
            masterId: user.master_id?.toString() || '',
            date: dateString
        });
        return fetch(`/api/crm/tasks-master-calendar?${params}`);
    }
});
```

3. **–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å**
- –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á (–Ω–µ —Å–µ—Ç–∫–∞)
- –ù–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –¥–∞—Ç–∞–º
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–Ω—è
- –¶–≤–µ—Ç–æ–≤—ã–µ –º–µ—Ç–∫–∏ —Å—Ç–∞—Ç—É—Å–æ–≤

4. **–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É
- –ö–Ω–æ–ø–∫–∞ —Ä—É—á–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤:

```bash
# 1. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–¥ –º–∞—Å—Ç–µ—Ä–æ–º
# 2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /master/calendar
# 3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∑–∞–¥–∞—á–∏
# 4. –ü–æ–ø—ã—Ç–∞—Ç—å—Å—è –æ—Ç–∫—Ä—ã—Ç—å /crm/calendar ‚Üí —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ /master/calendar
# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É –Ω–∞–≤–∏–≥–∞—Ü–∏–∏ –ø–æ –¥–∞—Ç–∞–º
# 6. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
- ‚úÖ –í–∏–¥–Ω—ã —Ç–æ–ª—å–∫–æ –∑–∞–¥–∞—á–∏ —Ç–µ–∫—É—â–µ–≥–æ –º–∞—Å—Ç–µ—Ä–∞  
- ‚úÖ –î–æ—Å—Ç—É–ø –∫ `/crm/calendar` –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
- ‚úÖ API –∑–∞–ø—Ä–æ—Å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ `masterId` –∏ `date`

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:

```bash
# 1. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –ø–æ–¥ –∞–¥–º–∏–Ω–æ–º
# 2. –û—Ç–∫—Ä—ã—Ç—å /crm/calendar
# 3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –≤–∏–¥–Ω—ã –≤—Å–µ –º–∞—Å—Ç–µ—Ä–∞ —Ñ–∏–ª–∏–∞–ª–∞
# 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å drag & drop
# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ/—É–¥–∞–ª–µ–Ω–∏–µ –º–∞—Å—Ç–µ—Ä–æ–≤
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- ‚úÖ –ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–∞–∫ —Ä–∞–Ω—å—à–µ
- ‚úÖ –ù–∏–∫–∞–∫–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ
- ‚úÖ –í—Å–µ –º–∞—Å—Ç–µ—Ä–∞ —Ñ–∏–ª–∏–∞–ª–∞ –≤–∏–¥–Ω—ã

## –°–≤—è–∑–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### –ù–æ–≤—ã–µ —Ñ–∞–π–ª—ã:
- `src/pages/Calendar/MasterCalendarView.tsx` - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–∞–ª–µ–Ω–¥–∞—Ä—è –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤

### –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã:
- `src/App.tsx` - –æ–±–Ω–æ–≤–ª–µ–Ω —Ä–æ—É—Ç `/master/calendar`
- `src/components/SimpleProtectedRoute.tsx` - –∑–∞–ø—Ä–µ—â–µ–Ω –¥–æ—Å—Ç—É–ø –∫ `/crm/calendar` –¥–ª—è –º–∞—Å—Ç–µ—Ä–æ–≤
- `src/pages/MobileApp.tsx` - —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/master/calendar`
- `src/pages/Calendar/components/time-schedule.tsx` - –æ—Ç–∫–∞—á–µ–Ω—ã –≤—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –¥–ª—è —Ä–æ–ª–∏ master

### –§–∞–π–ª—ã –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π:
- `src/components/Sidebar.tsx` - —É–∂–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å `/master/calendar`
- `src/components/MobileNavbarMaster.tsx` - –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π

## API Requirements

### Backend –¥–æ–ª–∂–µ–Ω –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å:

**GET `/api/crm/tasks-master-calendar`**

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `masterId` (required, integer) - ID –º–∞—Å—Ç–µ—Ä–∞
- `date` (optional, string) - –î–∞—Ç–∞ –≤ —Ñ–æ—Ä–º–∞—Ç–µ YYYY-MM-DD

–û—Ç–≤–µ—Ç (200 OK):
```json
[
  {
    "id": 1,
    "title": "–°—Ç—Ä–∏–∂–∫–∞",
    "date": "2025-10-20",
    "time": "10:00",
    "start_time": "10:00",
    "end_time": "11:00",
    "master_name": "–ò–≤–∞–Ω –ò–≤–∞–Ω–æ–≤",
    "client_name": "–ü–µ—Ç—Ä –ü–µ—Ç—Ä–æ–≤",
    "service_name": "–ú—É–∂—Å–∫–∞—è —Å—Ç—Ä–∏–∂–∫–∞",
    "status": "scheduled",
    "duration": 60,
    "price": 1500,
    "notes": "–ö–ª–∏–µ–Ω—Ç –ø—Ä–æ—Å–∏—Ç –∫–æ—Ä–æ—Ç–∫—É—é —Å—Ç—Ä–∏–∂–∫—É",
    "paid": "unpaid"
  }
]
```

–û—à–∏–±–∫–∏:
- 400 - Master ID is required
- 500 - Server error

## –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–¥—Ö–æ–¥–∞

1. **–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏**
   - –ê–¥–º–∏–Ω—Å–∫–∏–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å –æ—Å—Ç–∞–ª—Å—è –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π
   - –ö–∞–ª–µ–Ω–¥–∞—Ä—å –º–∞—Å—Ç–µ—Ä–∞ - –æ—Ç–¥–µ–ª—å–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

2. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å API**
   - –ú–∞—Å—Ç–µ—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `/api/crm/tasks-master-calendar`
   - –ê–¥–º–∏–Ω—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

3. **–ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å**
   - –ú–∞—Å—Ç–µ—Ä–∞ –Ω–µ –º–æ–≥—É—Ç –≤–∏–¥–µ—Ç—å –¥—Ä—É–≥–∏—Ö –º–∞—Å—Ç–µ—Ä–æ–≤
   - –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω—Å–∫–æ–º—É –∫–∞–ª–µ–Ω–¥–∞—Ä—é –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

4. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∏**
   - –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –º–∞—Å—Ç–µ—Ä–∞ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –∞–¥–º–∏–Ω–æ–≤
   - –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∞–¥–º–∏–Ω—Å–∫–æ–º –∫–∞–ª–µ–Ω–¥–∞—Ä–µ –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ –º–∞—Å—Ç–µ—Ä–æ–≤

## –ê–≤—Ç–æ—Ä

–ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Elitaroma Frontend  
–î–∞—Ç–∞: 20 –æ–∫—Ç—è–±—Ä—è 2025 (–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ v2)
