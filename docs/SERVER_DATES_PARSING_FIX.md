# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–∞—Ä—Å–∏–Ω–≥–∞ –¥–∞—Ç —Å —Å–µ—Ä–≤–µ—Ä–∞ –¥–ª—è —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –º–∞—Å—Ç–µ—Ä–∞

## –î–∞—Ç–∞: 3 –Ω–æ—è–±—Ä—è 2025 –≥.

## –ü—Ä–æ–±–ª–µ–º–∞

–°–µ—Ä–≤–µ—Ä –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO —Å –≤—Ä–µ–º–µ–Ω–µ–º UTC:
```json
{
    "work_date": "2025-11-06T00:00:00.000Z",
    "start_time": "07:00",
    "end_time": "23:59",
    "branch_id": "1",
    "is_active": true
}
```

–ù–æ —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞ `format(new Date(date.work_date), 'yyyy-MM-dd')`, —á—Ç–æ –º–æ–≥–ª–æ –ø—Ä–∏–≤–æ–¥–∏—Ç—å –∫:
- ‚ùå –°–º–µ—â–µ–Ω–∏—é –¥–∞—Ç –∏–∑-–∑–∞ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–º—É –ø–∞—Ä—Å–∏–Ω–≥—É
- ‚ùå –ù–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—é –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–æ–º –∏ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–º

## –†–µ—à–µ–Ω–∏–µ

### 1. –£–ª—É—á—à–µ–Ω–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

**–ë—ã–ª–æ:**
```typescript
const convertServerToLocalFormat = (serverDates: ServerWorkingDate[]): WorkingDate[] => {
  return serverDates.map(date => ({
    date: format(new Date(date.work_date), 'yyyy-MM-dd'),
    startTime: date.start_time,
    endTime: date.end_time,
    branchId: date.branch_id
  }));
};
```

**–°—Ç–∞–ª–æ:**
```typescript
const convertServerToLocalFormat = (serverDates: ServerWorkingDate[]): WorkingDate[] => {
  return serverDates.map(date => {
    // –ü–∞—Ä—Å–∏–º –¥–∞—Ç—É –∏–∑ ISO —Ñ–æ—Ä–º–∞—Ç–∞ "2025-11-06T00:00:00.000Z"
    const workDate = new Date(date.work_date);
    
    // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤ yyyy-MM-dd –∏—Å–ø–æ–ª—å–∑—É—è UTC –º–µ—Ç–æ–¥—ã –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏
    const year = workDate.getUTCFullYear();
    const month = String(workDate.getUTCMonth() + 1).padStart(2, '0');
    const day = String(workDate.getUTCDate()).padStart(2, '0');
    const dateString = `${year}-${month}-${day}`;
    
    console.log('üìÖ Converting server date:', {
      original: date.work_date,
      parsed: workDate.toISOString(),
      formatted: dateString
    });
    
    return {
      date: dateString,
      startTime: date.start_time,
      endTime: date.end_time,
      branchId: date.branch_id
    };
  });
};
```

**–ü–æ—á–µ–º—É UTC –º–µ—Ç–æ–¥—ã:**
- `getUTCFullYear()`, `getUTCMonth()`, `getUTCDate()` - —Ä–∞–±–æ—Ç–∞—é—Ç —Å UTC –≤—Ä–µ–º–µ–Ω–µ–º
- –ò–∑–±–µ–≥–∞–µ–º —Å–º–µ—â–µ–Ω–∏—è —á–∞—Å–æ–≤—ã—Ö –ø–æ—è—Å–æ–≤
- –î–∞—Ç–∞ `2025-11-06T00:00:00.000Z` –≤—Å–µ–≥–¥–∞ –¥–∞—Å—Ç `2025-11-06`

### 2. –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ Date –æ–±—ä–µ–∫—Ç–æ–≤ –≤ useMemo

**–ë—ã–ª–æ:**
```typescript
const date = new Date(wd.date); // "2025-11-06"
date.setHours(12, 0, 0, 0);
```

**–°—Ç–∞–ª–æ:**
```typescript
// –ü–∞—Ä—Å–∏–º —Å—Ç—Ä–æ–∫—É —Ñ–æ—Ä–º–∞—Ç–∞ "YYYY-MM-DD"
const [year, month, day] = wd.date.split('-').map(Number);

// –°–æ–∑–¥–∞–µ–º Date –æ–±—ä–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É—è UTC –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –ø—Ä–æ–±–ª–µ–º —Å —á–∞—Å–æ–≤—ã–º–∏ –ø–æ—è—Å–∞–º–∏
const date = new Date(Date.UTC(year, month - 1, day, 12, 0, 0, 0));
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –Ø–≤–Ω–æ–µ —É–∫–∞–∑–∞–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ –¥–∞—Ç—ã
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ UTC –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
- ‚úÖ –ü–æ–ª–¥–µ–Ω—å UTC –¥–ª—è –∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç–∏
- ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞

### 3. –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

#### –ü—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞:
```typescript
console.log('üì• Raw server data received:', serverWorkingDates);
console.log('‚úÖ Server data converted:', {
  rawCount: serverWorkingDates.length,
  convertedCount: convertedDates.length,
  dates: convertedDates.map(d => d.date)
});
```

#### –ü—Ä–∏ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏ –≤ Date –æ–±—ä–µ–∫—Ç—ã:
```typescript
console.log('üìÖ Converting working date:', {
  original: wd.date,
  parsed: date.toISOString(),
  dateString: date.toDateString()
});
```

#### –ò—Ç–æ–≥–æ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:
```typescript
console.log('üìä Working days state update:', {
  workingDatesCount: workingDates.length,
  workingDaysCount: workingDays.length,
  workingDatesRaw: workingDates,
  workingDaysFormatted: workingDays.map(d => d.toISOString().split('T')[0]),
  workingDaysISO: workingDays.map(d => d.toISOString()),
  calendarKey,
  timestamp: new Date().toISOString()
});
```

## –ü–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

```
1. –°–µ—Ä–≤–µ—Ä
   ‚Üì
   "2025-11-06T00:00:00.000Z" (ISO UTC)
   ‚Üì
2. convertServerToLocalFormat()
   ‚Üì
   "2025-11-06" (yyyy-MM-dd string)
   ‚Üì
3. workingDates (WorkingDate[])
   ‚Üì
4. useMemo() ‚Üí workingDays
   ‚Üì
   Date object UTC (2025-11-06T12:00:00.000Z)
   ‚Üì
5. Calendar component
   ‚Üì
   –ó–µ–ª–µ–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ ‚úÖ
```

## –ü—Ä–∏–º–µ—Ä—ã

### –ü—Ä–∏–º–µ—Ä 1: –î–∞—Ç–∞ –±–µ–∑ —Å–º–µ—â–µ–Ω–∏—è

**–í—Ö–æ–¥ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:**
```json
"work_date": "2025-11-06T00:00:00.000Z"
```

**–ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è:**
```javascript
const workDate = new Date("2025-11-06T00:00:00.000Z");
// workDate.getUTCFullYear() = 2025
// workDate.getUTCMonth() = 10 (November, 0-based)
// workDate.getUTCDate() = 6

const dateString = "2025-11-06";
```

**–°–æ–∑–¥–∞–Ω–∏–µ Date –¥–ª—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è:**
```javascript
const [year, month, day] = "2025-11-06".split('-').map(Number);
// year = 2025, month = 11, day = 6

const date = new Date(Date.UTC(2025, 10, 6, 12, 0, 0, 0));
// date.toISOString() = "2025-11-06T12:00:00.000Z"
// date.toISOString().split('T')[0] = "2025-11-06" ‚úÖ
```

### –ü—Ä–∏–º–µ—Ä 2: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –¥–∞—Ç—ã

**–í—Ö–æ–¥ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:**
```json
[
  { "work_date": "2025-11-06T00:00:00.000Z", ... },
  { "work_date": "2025-11-07T00:00:00.000Z", ... },
  { "work_date": "2025-11-08T00:00:00.000Z", ... }
]
```

**–ü–æ—Å–ª–µ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏:**
```javascript
workingDates = [
  { date: "2025-11-06", startTime: "07:00", endTime: "23:59", branchId: "1" },
  { date: "2025-11-07", startTime: "07:00", endTime: "23:59", branchId: "1" },
  { date: "2025-11-08", startTime: "07:00", endTime: "23:59", branchId: "1" }
]
```

**–ü–æ—Å–ª–µ useMemo:**
```javascript
workingDays = [
  Date("2025-11-06T12:00:00.000Z"),
  Date("2025-11-07T12:00:00.000Z"),
  Date("2025-11-08T12:00:00.000Z")
]
```

**–í –∫–∞–ª–µ–Ω–¥–∞—Ä–µ:**
- 6 –Ω–æ—è–±—Ä—è üü¢
- 7 –Ω–æ—è–±—Ä—è üü¢
- 8 –Ω–æ—è–±—Ä—è üü¢

## –û—Ç–ª–∞–¥–∫–∞

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞

1. –û—Ç–∫—Ä—ã—Ç—å –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
2. –ù–∞–π—Ç–∏ –ª–æ–≥ `üì• Raw server data received:`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –¥–∞—Ç—ã –≤ —Ñ–æ—Ä–º–∞—Ç–µ ISO: `"2025-11-06T00:00:00.000Z"`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏

1. –ù–∞–π—Ç–∏ –ª–æ–≥–∏ `üìÖ Converting server date:`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ:
   - `original`: ISO —Ñ–æ—Ä–º–∞—Ç
   - `parsed`: ISO —Ñ–æ—Ä–º–∞—Ç (—Ç–æ—Ç –∂–µ)
   - `formatted`: `"YYYY-MM-DD"`

### –ü—Ä–æ–≤–µ—Ä–∫–∞ Date –æ–±—ä–µ–∫—Ç–æ–≤

1. –ù–∞–π—Ç–∏ –ª–æ–≥–∏ `üìÖ Converting working date:`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ:
   - `original`: —Å—Ç—Ä–æ–∫–∞ `"YYYY-MM-DD"`
   - `parsed`: ISO —Å –ø–æ–ª–¥–Ω–µ–º UTC
   - `dateString`: —á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –∏—Ç–æ–≥–æ–≤–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è

1. –ù–∞–π—Ç–∏ –ª–æ–≥ `üìä Working days state update:`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ:
   - `workingDatesCount` = `workingDaysCount`
   - `workingDaysFormatted` —Å–æ–¥–µ—Ä–∂–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –¥–∞—Ç—ã
   - –î–∞—Ç—ã —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –¥–∞—Ç–∞–º–∏ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞

## –ì–∞—Ä–∞–Ω—Ç–∏–∏

–ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:

‚úÖ **–¢–æ—á–Ω–æ—Å—Ç—å –¥–∞—Ç** - –¥–∞—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ = –¥–∞—Ç–∞ –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ  
‚úÖ **–ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —á–∞—Å–æ–≤–æ–≥–æ –ø–æ—è—Å–∞** - UTC –º–µ—Ç–æ–¥—ã –≤–µ–∑–¥–µ  
‚úÖ **–ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–æ—Å—Ç—å** - –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –∫–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏–∏  
‚úÖ **–û—Ç–ª–∞–¥–æ—á–Ω–æ—Å—Ç—å** - –ø–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ –∫–∞–∂–¥–æ–º —ç—Ç–∞–ø–µ  
‚úÖ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å** - –∑–∞—â–∏—Ç–∞ –æ—Ç edge cases  

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç-–∫–µ–π—Å 1: –û–¥–Ω–∞ –¥–∞—Ç–∞

```
–í—Ö–æ–¥: { "work_date": "2025-11-06T00:00:00.000Z" }
–û–∂–∏–¥–∞–Ω–∏–µ: 6 –Ω–æ—è–±—Ä—è –∑–µ–ª–µ–Ω—ã–π
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ
```

### –¢–µ—Å—Ç-–∫–µ–π—Å 2: –ù–µ—Å–∫–æ–ª—å–∫–æ –¥–∞—Ç

```
–í—Ö–æ–¥: 
  { "work_date": "2025-11-06T00:00:00.000Z" }
  { "work_date": "2025-11-07T00:00:00.000Z" }
  { "work_date": "2025-11-08T00:00:00.000Z" }
  
–û–∂–∏–¥–∞–Ω–∏–µ: 6, 7, 8 –Ω–æ—è–±—Ä—è –∑–µ–ª–µ–Ω—ã–µ
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ
```

### –¢–µ—Å—Ç-–∫–µ–π—Å 3: –†–∞–∑–Ω—ã–µ –º–µ—Å—è—Ü—ã

```
–í—Ö–æ–¥:
  { "work_date": "2025-11-30T00:00:00.000Z" }
  { "work_date": "2025-12-01T00:00:00.000Z" }
  
–û–∂–∏–¥–∞–Ω–∏–µ: 30 –Ω–æ—è–±—Ä—è –∏ 1 –¥–µ–∫–∞–±—Ä—è –∑–µ–ª–µ–Ω—ã–µ
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ
```

### –¢–µ—Å—Ç-–∫–µ–π—Å 4: –†–∞–∑–Ω—ã–µ —á–∞—Å–æ–≤—ã–µ –ø–æ—è—Å–∞ –±—Ä–∞—É–∑–µ—Ä–∞

```
–î–µ–π—Å—Ç–≤–∏–µ: –ò–∑–º–µ–Ω–∏—Ç—å timezone –≤ DevTools
–í–∞—Ä–∏–∞–Ω—Ç—ã: UTC, GMT+3, GMT-5, Asia/Tokyo

–û–∂–∏–¥–∞–Ω–∏–µ: –î–∞—Ç—ã –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ
–†–µ–∑—É–ª—å—Ç–∞—Ç: ‚úÖ (–±–ª–∞–≥–æ–¥–∞—Ä—è UTC –º–µ—Ç–æ–¥–∞–º)
```

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [RELIABLE_WORKING_DAYS_SYSTEM.md](./RELIABLE_WORKING_DAYS_SYSTEM.md) - –û—Å–Ω–æ–≤–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞
- [MASTER_WORKING_DAYS_CALENDAR_FIX.md](./MASTER_WORKING_DAYS_CALENDAR_FIX.md) - –í–∏–∑—É–∞–ª—å–Ω–æ–µ –≤—ã–¥–µ–ª–µ–Ω–∏–µ

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

`/src/components/MasterWorkingDatesManager.tsx`:
- –û–±–Ω–æ–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `convertServerToLocalFormat()`
- –û–±–Ω–æ–≤–ª–µ–Ω useMemo –¥–ª—è `workingDays`
- –î–æ–±–∞–≤–ª–µ–Ω–æ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–¢–µ–ø–µ—Ä—å —Å–∏—Å—Ç–µ–º–∞ **–≥–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ** –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –¥–∞—Ç—ã –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞:

1. ‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ ISO —Ñ–æ—Ä–º–∞—Ç–∞ —Å UTC
2. ‚úÖ –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ —Å—Ç—Ä–æ–∫—É –±–µ–∑ —Å–º–µ—â–µ–Ω–∏—è
3. ‚úÖ –°–æ–∑–¥–∞–Ω–∏–µ Date –æ–±—ä–µ–∫—Ç–æ–≤ —Å UTC
4. ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ timezone
5. ‚úÖ –ü–æ–ª–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–∞–∂–¥–æ–≥–æ —à–∞–≥–∞

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–∞—Ç—ã –≤ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ = –¥–∞—Ç—ã –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞! üéØ
