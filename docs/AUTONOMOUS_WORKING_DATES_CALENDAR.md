# –ê–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∫–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π

## –ü—Ä–æ–±–ª–µ–º–∞
–ö–∞–ª–µ–Ω–¥–∞—Ä—å —Ä–∞–±–æ—á–∏—Ö –¥–Ω–µ–π –º–∞—Å—Ç–µ—Ä–∞ –∑–∞–≤–∏—Å–µ–ª –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞ –∏ –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è, –∫–æ—Ç–æ—Ä–æ–µ:
- –¢–µ—Ä—è–ª–æ—Å—å –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
- –ù–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–ª–æ—Å—å —Å —Å–µ—Ä–≤–µ—Ä–æ–º –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- –¢—Ä–µ–±–æ–≤–∞–ª–æ –ø–µ—Ä–µ–¥–∞—á–∏ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ props
- –ü—Ä–∏–º–µ–Ω—è–ª–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑, –ø–æ—Å–ª–µ —á–µ–≥–æ "—Å–ª–µ—Ç–∞–ª–æ"

## –†–µ—à–µ–Ω–∏–µ: –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

#### –î–û (–∑–∞–≤–∏—Å–∏–º—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç):
```typescript
interface MasterWorkingDatesManagerProps {
  workingDates: WorkingDate[];  // ‚ùå –ü–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑–≤–Ω–µ
  onWorkingDatesChange: (dates: WorkingDate[]) => void;  // ‚ùå –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –Ω–∞—Ä—É–∂—É
  masterId?: number;
}

// –í —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ (Masters.tsx):
const [workingDates, setWorkingDates] = useState<WorkingDate[]>([]);

<MasterWorkingDatesManager
  workingDates={workingDates}  // ‚ùå –ü–µ—Ä–µ–¥–∞–µ–º –¥–∞–Ω–Ω—ã–µ
  onWorkingDatesChange={handleWorkingDatesChange}  // ‚ùå –ü–æ–ª—É—á–∞–µ–º callback
  masterId={master?.id}
/>
```

**–ü—Ä–æ–±–ª–µ–º—ã:**
- –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ —Å—Ç—Ä–∞–Ω–∏—Ü—ã `workingDates` —Ç–µ—Ä—è–ª–∏—Å—å
- –†–æ–¥–∏—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã–ª —É–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
- –î–∞–Ω–Ω—ã–µ –º–æ–≥–ª–∏ –±—ã—Ç—å –Ω–µ—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —Å —Å–µ—Ä–≤–µ—Ä–æ–º
- –¢—Ä–µ–±–æ–≤–∞–ª–∞—Å—å –¥–≤—É—Ö—Å—Ç–æ—Ä–æ–Ω–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è state

#### –ü–û–°–õ–ï (–∞–≤—Ç–æ–Ω–æ–º–Ω—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç):
```typescript
interface MasterWorkingDatesManagerProps {
  masterId: number;  // ‚úÖ –¢–æ–ª—å–∫–æ ID –º–∞—Å—Ç–µ—Ä–∞
}

// –í–Ω—É—Ç—Ä–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞:
const [workingDates, setWorkingDates] = useState<WorkingDate[]>([]);  // ‚úÖ –õ–û–ö–ê–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ

// –í —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ (Masters.tsx):
<MasterWorkingDatesManager
  masterId={master?.id!}  // ‚úÖ –¢–æ–ª—å–∫–æ ID
/>
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —Å–∞–º —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
- –ù–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è
- –í—Å–µ–≥–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î

### –ú–µ—Ö–∞–Ω–∏–∑–º –∞–≤—Ç–æ–Ω–æ–º–Ω–æ—Å—Ç–∏

#### 1. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
```typescript
const MasterWorkingDatesManager: React.FC<MasterWorkingDatesManagerProps> = ({
  masterId
}) => {
  // –õ–û–ö–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤—Ç–æ–Ω–æ–º–µ–Ω
  const [workingDates, setWorkingDates] = useState<WorkingDate[]>([]);
  
  // –û—Å—Ç–∞–ª—å–Ω—ã–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è...
  const [calendarKey, setCalendarKey] = useState(Date.now());
  const [selectedDates, setSelectedDates] = useState<Date[]>([]);
  // ...
}
```

#### 2. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
```typescript
// –ó–∞–≥—Ä—É–∂–∞–µ–º —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏ —Å —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
const { data: serverWorkingDates, isLoading, refetch } = useQuery<ServerWorkingDate[]>({
  queryKey: ['working-dates', masterId],
  queryFn: async () => {
    if (!masterId) return [];
    console.log('üîÑ Fetching working dates for master:', masterId);
    const response = await fetch(`${BACKEND_URL}/api/masters/${masterId}/working-dates`);
    if (!response.ok) throw new Error('Failed to fetch working dates');
    const data = await response.json();
    console.log('‚úÖ Fetched working dates:', data);
    return data;
  },
  enabled: !!masterId,
  refetchOnMount: 'always',  // ‚úÖ –í—Å–µ–≥–¥–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞—Ç—å
  refetchOnWindowFocus: false,
  staleTime: 0,  // ‚úÖ –í—Å–µ–≥–¥–∞ —Å—á–∏—Ç–∞—Ç—å —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏
});
```

#### 3. –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏
```typescript
// CRITICAL: –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
useEffect(() => {
  if (masterId) {
    console.log('üöÄ Component mounted, fetching working dates for master:', masterId);
    refetchWorkingDates();
  }
}, [masterId, refetchWorkingDates]);
```

#### 4. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ª–æ–∫–∞–ª—å–Ω—ã–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º
```typescript
// –û–±–Ω–æ–≤–ª—è–µ–º –ª–æ–∫–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö —Å —Å–µ—Ä–≤–µ—Ä–∞
useEffect(() => {
  if (serverWorkingDates && masterId) {
    console.log('üì• Raw server data received:', serverWorkingDates);
    
    const convertedDates = convertServerToLocalFormat(serverWorkingDates);
    
    console.log('‚úÖ Server data converted:', {
      rawCount: serverWorkingDates.length,
      convertedCount: convertedDates.length,
      dates: convertedDates.map(d => d.date)
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –õ–û–ö–ê–õ–¨–ù–û–ï —Å–æ—Å—Ç–æ—è–Ω–∏–µ - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤—Ç–æ–Ω–æ–º–µ–Ω
    setWorkingDates(convertedDates);
    
    // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –æ–±–Ω–æ–≤–ª—è–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—å
    forceRefreshCalendar();
    
    console.log('‚úÖ Calendar refreshed with server data');
  }
}, [serverWorkingDates, masterId]);
```

#### 5. –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–π
```typescript
// –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
const createWorkingDateMutation = useMutation({
  mutationFn: async (data) => { /* POST –∑–∞–ø—Ä–æ—Å */ },
  onSuccess: () => {
    console.log('‚úÖ Working date created, refetching from server...');
    refetchWorkingDates();  // ‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
  }
});

// –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
const deleteWorkingDateMutation = useMutation({
  mutationFn: async (data) => { /* DELETE –∑–∞–ø—Ä–æ—Å */ },
  onSuccess: () => {
    console.log('‚úÖ Working date deleted, refetching from server...');
    refetchWorkingDates();  // ‚úÖ –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
  }
});
```

## –ñ–∏–∑–Ω–µ–Ω–Ω—ã–π —Ü–∏–∫–ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ü–µ—Ä–≤–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞
```
1. –î–∏–∞–ª–æ–≥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
2. MasterWorkingDatesManager –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
3. useQuery –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è —Å enabled: true
4. refetchOnMount: 'always' —Ñ–æ—Ä—Å–∏—Ä—É–µ—Ç –∑–∞–≥—Ä—É–∑–∫—É
5. useEffect –≤—ã–∑—ã–≤–∞–µ—Ç refetchWorkingDates() (–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –≥–∞—Ä–∞–Ω—Ç–∏—è)
6. GET /api/masters/{id}/working-dates
7. –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è (UTC ‚Üí –ª–æ–∫–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç)
8. setWorkingDates() –æ–±–Ω–æ–≤–ª—è–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ
9. forceRefreshCalendar() –æ–±–Ω–æ–≤–ª—è–µ—Ç UI
10. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –¥–∞—Ç—É –∏ –Ω–∞–∂–∏–º–∞–µ—Ç "–î–æ–±–∞–≤–∏—Ç—å"
2. createWorkingDateMutation.mutate()
3. POST /api/masters/{id}/working-dates
4. onSuccess –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
5. refetchWorkingDates() –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
6. GET /api/masters/{id}/working-dates (—Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ)
7. –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
8. setWorkingDates() –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
9. forceRefreshCalendar() –æ–±–Ω–æ–≤–ª—è–µ—Ç UI
10. –ù–æ–≤—ã–π –¥–µ–Ω—å –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è –∑–µ–ª–µ–Ω—ã–º ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 3: –£–¥–∞–ª–µ–Ω–∏–µ —Ä–∞–±–æ—á–µ–≥–æ –¥–Ω—è
```
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –¥–Ω–∏ –∏ –Ω–∞–∂–∏–º–∞–µ—Ç "–£–¥–∞–ª–∏—Ç—å"
2. deleteWorkingDateMutation.mutate()
3. DELETE /api/masters/{id}/working-dates/{date}
4. onSuccess –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è
5. refetchWorkingDates() –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
6. GET /api/masters/{id}/working-dates (—Å–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ)
7. –î–∞–Ω–Ω—ã–µ –∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É—é—Ç—Å—è
8. setWorkingDates() –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ
9. forceRefreshCalendar() –æ–±–Ω–æ–≤–ª—è–µ—Ç UI
10. –ü–æ–¥—Å–≤–µ—Ç–∫–∞ —É–¥–∞–ª–µ–Ω–Ω—ã—Ö –¥–Ω–µ–π –∏—Å—á–µ–∑–∞–µ—Ç ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 4: –ó–∞–∫—Ä—ã—Ç—å –∏ –æ—Ç–∫—Ä—ã—Ç—å —Å–Ω–æ–≤–∞
```
1. –î–∏–∞–ª–æ–≥ –∑–∞–∫—Ä—ã–≤–∞–µ—Ç—Å—è
2. MasterWorkingDatesManager —Ä–∞–∑–º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
3. –õ–æ–∫–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ç–µ—Ä—è–µ—Ç—Å—è (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ!)
4. –î–∏–∞–ª–æ–≥ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è —Å–Ω–æ–≤–∞
5. MasterWorkingDatesManager –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ
6. refetchOnMount: 'always' ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
7. –°–≤–µ–∂–∏–µ –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î
8. –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ ‚úÖ
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 5: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
```
1. F5 / Ctrl+R
2. –í—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
3. –ü—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ –¥–∏–∞–ª–æ–≥–∞:
   ‚Üí MasterWorkingDatesManager –º–æ–Ω—Ç–∏—Ä—É–µ—Ç—Å—è
   ‚Üí refetchOnMount: 'always' ‚Üí –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
   ‚Üí –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –∏–∑ –ë–î ‚úÖ
```

## –ì–∞—Ä–∞–Ω—Ç–∏–∏ —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ –î–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ –∞–∫—Ç—É–∞–ª—å–Ω—ã
- –ö–∞–∂–¥–æ–µ –æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —Å —Å–µ—Ä–≤–µ—Ä–∞
- `staleTime: 0` - –¥–∞–Ω–Ω—ã–µ –≤—Å–µ–≥–¥–∞ —Å—á–∏—Ç–∞—é—Ç—Å—è —É—Å—Ç–∞—Ä–µ–≤—à–∏–º–∏
- `refetchOnMount: 'always'` - –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞

### ‚úÖ –ù–µ–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—è
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ props
- –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –Ω–µ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ callbacks
- –†–æ–¥–∏—Ç–µ–ª—å –Ω–µ —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º –∫–∞–ª–µ–Ω–¥–∞—Ä—è

### ‚úÖ –£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞–º
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞
- –ó–∞–∫—Ä—ã—Ç–∏–µ/–æ—Ç–∫—Ä—ã—Ç–∏–µ –¥–∏–∞–ª–æ–≥–∞ –Ω–µ –ø—Ä–æ–±–ª–µ–º–∞
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∞—Å—Ç–µ—Ä–∞–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç

### ‚úÖ –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å –ë–î
- –ü–æ—Å–ª–µ –∫–∞–∂–¥–æ–π –º—É—Ç–∞—Ü–∏–∏ - –∑–∞–≥—Ä—É–∑–∫–∞ —Å —Å–µ—Ä–≤–µ—Ä–∞
- –ù–µ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫—ç—à–∞, –∫–æ—Ç–æ—Ä—ã–π –º–æ–∂–µ—Ç —É—Å—Ç–∞—Ä–µ—Ç—å
- Single source of truth - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ –∫–æ–¥–µ

### MasterWorkingDatesManager.tsx
```diff
- interface MasterWorkingDatesManagerProps {
-   workingDates: WorkingDate[];
-   onWorkingDatesChange: (dates: WorkingDate[]) => void;
-   masterId?: number;
- }
+ interface MasterWorkingDatesManagerProps {
+   masterId: number;
+ }

- const MasterWorkingDatesManager: React.FC<MasterWorkingDatesManagerProps> = ({
-   workingDates,
-   onWorkingDatesChange,
-   masterId
- }) => {
+ const MasterWorkingDatesManager: React.FC<MasterWorkingDatesManagerProps> = ({
+   masterId
+ }) => {
+   // –õ–û–ö–ê–õ–¨–ù–û–ï –°–û–°–¢–û–Ø–ù–ò–ï - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤—Ç–æ–Ω–æ–º–µ–Ω
+   const [workingDates, setWorkingDates] = useState<WorkingDate[]>([]);

-   onWorkingDatesChange(convertedDates);
+   setWorkingDates(convertedDates);
```

### Masters.tsx
```diff
- const [workingDates, setWorkingDates] = useState<WorkingDate[]>([]);
- 
- const { data: fetchedWorkingDates } = useQuery({
-   queryKey: ['working-dates', master?.id],
-   queryFn: async () => { /* ... */ },
-   enabled: !!master
- });
- 
- const handleWorkingDatesChange = (newWorkingDates: WorkingDate[]) => {
-   setWorkingDates(newWorkingDates);
- };

+ // workingDates –±–æ–ª—å—à–µ –ù–ï –Ω—É–∂–Ω—ã - –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∞–≤—Ç–æ–Ω–æ–º–µ–Ω

  <MasterWorkingDatesManager
-   workingDates={workingDates}
-   onWorkingDatesChange={handleWorkingDatesChange}
-   masterId={master?.id}
+   masterId={master?.id!}
  />
```

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä—É–µ—Ç –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏:

```
üöÄ Component mounted, fetching working dates for master: 15
üîÑ Fetching working dates for master: 15
‚úÖ Fetched working dates: [...]
üì• Raw server data received: [...]
‚úÖ Server data converted: { rawCount: 5, convertedCount: 5 }
‚úÖ Calendar refreshed with server data
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
- **–î–µ–π—Å—Ç–≤–∏–µ:** –û—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Å—Ç–µ—Ä–∞
- **–û–∂–∏–¥–∞–Ω–∏–µ:** –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞–±–æ—á–∏–µ –¥–Ω–∏
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** Console –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "üöÄ Component mounted"

### –¢–µ—Å—Ç 2: –î–æ–±–∞–≤–∏—Ç—å –¥–µ–Ω—å
- **–î–µ–π—Å—Ç–≤–∏–µ:** –í—ã–±—Ä–∞—Ç—å –¥–∞—Ç—É, –¥–æ–±–∞–≤–∏—Ç—å —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
- **–û–∂–∏–¥–∞–Ω–∏–µ:** –î–µ–Ω—å —Å—Ä–∞–∑—É –ø–æ–¥—Å–≤–µ—á–∏–≤–∞–µ—Ç—Å—è
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** Console –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "‚úÖ Working date created, refetching"

### –¢–µ—Å—Ç 3: –£–¥–∞–ª–∏—Ç—å –¥–µ–Ω—å
- **–î–µ–π—Å—Ç–≤–∏–µ:** –£–¥–∞–ª–∏—Ç—å —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
- **–û–∂–∏–¥–∞–Ω–∏–µ:** –ü–æ–¥—Å–≤–µ—Ç–∫–∞ –∏—Å—á–µ–∑–∞–µ—Ç
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** Console –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "‚úÖ Working date deleted, refetching"

### –¢–µ—Å—Ç 4: F5 (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã)
- **–î–µ–π—Å—Ç–≤–∏–µ:** F5 ‚Üí –æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
- **–û–∂–∏–¥–∞–Ω–∏–µ:** –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –î–∞–Ω–Ω—ã–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç —Å –ë–î

### –¢–µ—Å—Ç 5: –ó–∞–∫—Ä—ã—Ç—å/–æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
- **–î–µ–π—Å—Ç–≤–∏–µ:** –ó–∞–∫—Ä—ã—Ç—å ‚Üí –æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥ —Å–Ω–æ–≤–∞
- **–û–∂–∏–¥–∞–Ω–∏–µ:** –ö–∞–ª–µ–Ω–¥–∞—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –ù–æ–≤–æ–µ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —Å–≤–µ–∂–∞—è –∑–∞–≥—Ä—É–∑–∫–∞

### –¢–µ—Å—Ç 6: –î–≤–µ –≤–∫–ª–∞–¥–∫–∏
- **–î–µ–π—Å—Ç–≤–∏–µ:** –û—Ç–∫—Ä—ã—Ç—å –º–∞—Å—Ç–µ—Ä–∞ –≤ –¥–≤—É—Ö –≤–∫–ª–∞–¥–∫–∞—Ö
  - –í–∫–ª–∞–¥–∫–∞ 1: –¥–æ–±–∞–≤–∏—Ç—å –¥–µ–Ω—å
  - –í–∫–ª–∞–¥–∫–∞ 2: –∑–∞–∫—Ä—ã—Ç—å/–æ—Ç–∫—Ä—ã—Ç—å –¥–∏–∞–ª–æ–≥
- **–û–∂–∏–¥–∞–Ω–∏–µ:** –í–∫–ª–∞–¥–∫–∞ 2 –≤–∏–¥–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∏–∑ –≤–∫–ª–∞–¥–∫–∏ 1
- **–ü—Ä–æ–≤–µ—Ä–∫–∞:** –î–∞–Ω–Ω—ã–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ –ë–î

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã
- `/docs/WORKING_DATES_AUTO_REFETCH.md` - —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏
- `/docs/SERVER_DATES_PARSING_FIX.md` - –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π –ø–∞—Ä—Å–∏–Ω–≥ UTC –¥–∞—Ç
- `/docs/RELIABLE_WORKING_DAYS_SYSTEM.md` - –Ω–∞–¥–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –±–µ–∑ –∫—ç—à–∞

## –î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
3 –Ω–æ—è–±—Ä—è 2025 –≥.
