# üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ "–ø—Ä—ã–∂–∫–æ–≤" UI –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏

## ‚ùå –ü—Ä–æ–±–ª–µ–º–∞

–ù–µ—Å–º–æ—Ç—Ä—è –Ω–∞ —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è, –º–æ–±–∏–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è –∫–∞–ª–µ–Ω–¥–∞—Ä—è –≤—Å—ë —Ä–∞–≤–Ω–æ "–ø—Ä—ã–≥–∞–ª–∞".

## üîç –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã

### 1. **–ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ URL (–∫–∞–∂–¥—ã–µ 500–º—Å)**
```typescript
// ‚ùå –ë–´–õ–û –≤ Calendar/index.tsx:
const interval = setInterval(checkUrlPeriodically, 500); // –ö–∞–∂–¥—ã–µ 500–º—Å!
```

–≠—Ç–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∑—ã–≤–∞–ª–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω—ã–µ —Ä–µ—Ä–µ–Ω–¥–µ—Ä—ã –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞!

### 2. **–°–ª–∏—à–∫–æ–º —á–∞—Å—Ç—ã–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è API (–∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã)**
```typescript
// ‚ùå –ë–´–õ–û:
refetchInterval: isMobile ? 1000 * 60 * 2 : 1000 * 30, // 2 –º–∏–Ω—É—Ç—ã
```

–î–ª—è Safari –Ω–∞ iOS –¥–∞–∂–µ 2 –º–∏–Ω—É—Ç—ã –±—ã–ª–æ –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ.

## ‚úÖ –†–µ—à–µ–Ω–∏–µ

### 1. –£–±—Ä–∞–Ω–∞ –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ URL

**–§–∞–π–ª:** `src/pages/Calendar/index.tsx`

```typescript
// ‚úÖ –°–¢–ê–õ–û - —Ç–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è:
useEffect(() => {
  const handlePopState = () => {
    handleUrlChange();
  };

  const handleHashChange = () => {
    handleUrlChange();
  };

  window.addEventListener('popstate', handlePopState);
  window.addEventListener('hashchange', handleHashChange);
  
  return () => {
    window.removeEventListener('popstate', handlePopState);
    window.removeEventListener('hashchange', handleHashChange);
  };
}, [selectedDate]);
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚ùå –£–±—Ä–∞–Ω `setInterval(checkUrlPeriodically, 500)`
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `hashchange` listener
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ –ø–æ —Å–æ–±—ã—Ç–∏—è–º –±—Ä–∞—É–∑–µ—Ä–∞

### 2. –£–≤–µ–ª–∏—á–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö

**–§–∞–π–ª:** `src/hooks/use-device.ts`

```typescript
// ‚úÖ –°–¢–ê–õ–û:
export function useRefetchSettings() {
  const isMobile = useIsMobile();

  return {
    isMobile,
    // Desktop: 30 —Å–µ–∫—É–Ω–¥
    // Mobile: 5 –º–∏–Ω—É—Ç (300 —Å–µ–∫—É–Ω–¥)
    refetchInterval: isMobile ? 1000 * 60 * 5 : 1000 * 30,
    staleTime: isMobile ? 1000 * 60 * 5 : 1000 * 30,
    // –ù–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –æ—Ç–∫–ª—é—á–∞–µ–º –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ
    refetchOnWindowFocus: !isMobile,
    refetchIntervalInBackground: false
  };
}
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚è±Ô∏è Mobile: 2 –º–∏–Ω ‚Üí **5 –º–∏–Ω—É—Ç**
- üö´ –û—Ç–∫–ª—é—á–µ–Ω–æ `refetchOnWindowFocus` –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
- ‚úÖ –¢–æ–ª—å–∫–æ Desktop –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### Desktop (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π):
- ‚ö° –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ: **–∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥**
- üîÑ –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ: **–∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**
- üìà –ó–∞–ø—Ä–æ—Å–æ–≤/—á–∞—Å: **120**

### Mobile (–æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–æ):
| –ü–∞—Ä–∞–º–µ—Ç—Ä | –ë—ã–ª–æ | –°—Ç–∞–ª–æ |
|----------|------|-------|
| –ò–Ω—Ç–µ—Ä–≤–∞–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è | 2 –º–∏–Ω | **5 –º–∏–Ω** |
| –ó–∞–ø—Ä–æ—Å–æ–≤ –≤ —á–∞—Å | 30 | **12** |
| –ü—Ä–æ–≤–µ—Ä–∫–∞ URL | 500–º—Å | **–¢–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è** |
| refetchOnWindowFocus | ‚úÖ | **‚ùå** |
| –≠–∫–æ–Ω–æ–º–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ | 75% | **90%** |

### –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã "–ø—Ä—ã–∂–∫–∏" UI:
- ‚ùå –ù–µ—Ç –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫ URL
- ‚ùå –ù–µ—Ç —á–∞—Å—Ç—ã—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚ùå –ù–µ—Ç –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
- ‚úÖ –¢–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
- ‚úÖ –†–µ–¥–∫–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è (5 –º–∏–Ω)

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Desktop:
```bash
# –û—Ç–∫—Ä—ã—Ç—å DevTools ‚Üí Network
# –£–≤–∏–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å—ã –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ Mobile:
```bash
# 1. –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞ —Ç–µ–ª–µ—Ñ–æ–Ω–µ –∏–ª–∏ —É–º–µ–Ω—å—à–∏—Ç–µ –æ–∫–Ω–æ < 768px
# 2. –ó–∞–ø—Ä–æ—Å—ã –∫–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç
# 3. –ù–µ—Ç "–ø—Ä—ã–∂–∫–æ–≤" –ø—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏
# 4. –ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ Safari
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏—è –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫:
```javascript
// –í –∫–æ–Ω—Å–æ–ª–∏ –±—Ä–∞—É–∑–µ—Ä–∞:
console.log('Active intervals:', 
  window.setInterval.toString().includes('checkUrlPeriodically')
); // –î–æ–ª–∂–Ω–æ –±—ã—Ç—å false
```

## üì± Safari iOS –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è

–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ä—ã –¥–ª—è Safari:
- ‚úÖ –ë–µ–∑ `refetchOnWindowFocus` (–∏–∑–±–µ–≥–∞–µ–º –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)
- ‚úÖ –ò–Ω—Ç–µ—Ä–≤–∞–ª 5 –º–∏–Ω—É—Ç (–º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ "–ø—Ä—ã–∂–∫–∏")
- ‚úÖ –¢–æ–ª—å–∫–æ —Å–æ–±—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ (–Ω–µ—Ç polling)
- ‚úÖ –ù–µ—Ç —Ñ–æ–Ω–æ–≤—ã—Ö –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π

## üîÑ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### –ö–æ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö:
1. **–ö–∞–∂–¥—ã–µ 5 –º–∏–Ω—É—Ç** - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
2. **–ü—Ä–∏ –Ω–∞–≤–∏–≥–∞—Ü–∏–∏** - popstate, hashchange
3. **–ü—Ä–∏ –º–æ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏** - –ø–µ—Ä–≤–∞—è –∑–∞–≥—Ä—É–∑–∫–∞
4. **–í—Ä—É—á–Ω—É—é** - –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –∫–Ω–æ–ø–∫—É –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

### –ù–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è:
- ‚ùå –ü—Ä–∏ –≤–æ–∑–≤—Ä–∞—Ç–µ –Ω–∞ –≤–∫–ª–∞–¥–∫—É
- ‚ùå –ö–∞–∂–¥—ã–µ 500–º—Å (URL –ø—Ä–æ–≤–µ—Ä–∫–∞)
- ‚ùå –í —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ

## üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ï—Å–ª–∏ –≤—Å—ë –µ—â—ë –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã, –º–æ–∂–Ω–æ:

### 1. –î–æ–±–∞–≤–∏—Ç—å —Ä—É—á–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:
```typescript
// –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å" –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
{isMobile && (
  <Button onClick={() => refetch()}>
    –û–±–Ω–æ–≤–∏—Ç—å –¥–∞–Ω–Ω—ã–µ
  </Button>
)}
```

### 2. –£–≤–µ–ª–∏—á–∏—Ç—å –∏–Ω—Ç–µ—Ä–≤–∞–ª –µ—â—ë –±–æ–ª—å—à–µ:
```typescript
// –í use-device.ts:
refetchInterval: isMobile ? 1000 * 60 * 10 : 1000 * 30, // 10 –º–∏–Ω—É—Ç
```

### 3. –ü–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö:
```typescript
refetchInterval: isMobile ? false : 1000 * 30,
```

## üìù –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`src/hooks/use-device.ts`**
   - –£–≤–µ–ª–∏—á–µ–Ω –∏–Ω—Ç–µ—Ä–≤–∞–ª: 2 –º–∏–Ω ‚Üí 5 –º–∏–Ω
   - –û—Ç–∫–ª—é—á–µ–Ω refetchOnWindowFocus –¥–ª—è mobile

2. **`src/pages/Calendar/index.tsx`**
   - –£–±—Ä–∞–Ω setInterval(500ms)
   - –î–æ–±–∞–≤–ª–µ–Ω hashchange listener
   - –¢–æ–ª—å–∫–æ event-based –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## ‚úÖ –°—Ç–∞—Ç—É—Å

- ‚úÖ –ü–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ URL —É–±—Ä–∞–Ω—ã
- ‚úÖ –ò–Ω—Ç–µ—Ä–≤–∞–ª —É–≤–µ–ª–∏—á–µ–Ω –¥–æ 5 –º–∏–Ω—É—Ç
- ‚úÖ –û—Ç–∫–ª—é—á–µ–Ω–æ –∞–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–∏ —Ñ–æ–∫—É—Å–µ
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è 90% –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ mobile
- ‚úÖ –ü–ª–∞–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞ –≤ Safari iOS

---

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 26 –Ω–æ—è–±—Ä—è 2025  
**–ü—Ä–æ–±–ª–µ–º–∞:** "–ü—Ä—ã–∂–∫–∏" UI –Ω–∞ –º–æ–±–∏–ª—å–Ω–æ–π –≤–µ—Ä—Å–∏–∏  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–æ  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö
