# üöÄ Booking API - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ

–ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω—ã –≤—Å–µ –≤–∞—à–∏ booking —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∫–ª–∏–µ–Ω—Ç–æ–≤ –±–µ–∑ –∞–∫–∫–∞—É–Ω—Ç–∞.

---

## üì¶ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`src/services/booking-service.ts`** - —Å–µ—Ä–≤–∏—Å —Å —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å booking API
2. **`docs/BOOKING_API_INTEGRATION.md`** - –ø–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è (—á–∏—Ç–∞—Ç—å –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!)

## üîß –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **`src/lib/api.ts`** - –¥–æ–±–∞–≤–ª–µ–Ω —Ä–æ—É—Ç–∏–Ω–≥ –¥–ª—è `/booking/*`
2. **`src/pages/Booking.tsx`** - –æ–±–Ω–æ–≤–ª–µ–Ω –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –Ω–æ–≤—ã—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

---

## üéØ –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ç–∞—Ç—É—Å |
|-------|----------|----------|--------|
| GET | `/booking/organizations` | –°–ø–∏—Å–æ–∫ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π | ‚úÖ |
| GET | `/booking/organizations/{id}` | –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è –ø–æ ID | ‚úÖ |
| GET | `/booking/branches` | –°–ø–∏—Å–æ–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤ | ‚úÖ |
| GET | `/booking/branches/{id}` | –§–∏–ª–∏–∞–ª –ø–æ ID | ‚úÖ |
| GET | `/booking/staff` | –°–ø–∏—Å–æ–∫ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ | ‚úÖ |
| GET | `/booking/auth/{orgId}` | –ì–æ—Å—Ç–µ–≤–æ–π —Ç–æ–∫–µ–Ω | ‚úÖ |
| POST | `/booking/assignments` | –°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å | ‚úÖ |

---

## üöÄ –ö–∞–∫ –∑–∞–ø—É—Å—Ç–∏—Ç—å

### 1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env —Ñ–∞–π–ª

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –Ω–∞—Å—Ç—Ä–æ–µ–Ω `VITE_SECONDARY_BACKEND_URL`:

```env
VITE_SECONDARY_BACKEND_URL=https://your-api.com
```

### 2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä

```bash
npm run dev
```

### 3. –û—Ç–∫—Ä–æ–π—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É booking

```
http://localhost:5173/booking?organisationId=1
```

**–ó–∞–º–µ–Ω–∏—Ç–µ `1` –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π ID –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏!**

---

## üß™ –ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

### –¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

1. –û—Ç–∫—Ä–æ–π—Ç–µ `/booking?organisationId=1`
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Console
3. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:
   ```
   üîë Fetching guest token for organization: 1
   ‚úÖ Guest token received and saved
   ```
4. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Application ‚Üí Local Storage
5. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∫–ª—é—á `guest_token` —Å —Ç–æ–∫–µ–Ω–æ–º

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚¨ú PASS / ‚¨ú FAIL

---

### –¢–µ—Å—Ç 2: –í—ã–±–æ—Ä —Ñ–∏–ª–∏–∞–ª–∞

1. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤
2. –û—Ç–∫—Ä–æ–π—Ç–µ DevTools ‚Üí Network
3. –î–æ–ª–∂–µ–Ω –±—ã—Ç—å –∑–∞–ø—Ä–æ—Å: `GET /booking/branches?organizationId=1`
4. –°—Ç–∞—Ç—É—Å: `200 OK`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚¨ú PASS / ‚¨ú FAIL

---

### –¢–µ—Å—Ç 3: –í—ã–±–æ—Ä –º–∞—Å—Ç–µ—Ä–∞

1. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª–∏–∞–ª, —É—Å–ª—É–≥—É –∏ –¥–∞—Ç—É
2. –ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –≤—ã–±–æ—Ä–∞ –º–∞—Å—Ç–µ—Ä–∞ –¥–æ–ª–∂–µ–Ω –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å—Å—è —Å–ø–∏—Å–æ–∫
3. –í Network: `GET /booking/staff?branchId=...`
4. –°—Ç–∞—Ç—É—Å: `200 OK`

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚¨ú PASS / ‚¨ú FAIL

---

### –¢–µ—Å—Ç 4: –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏

1. –ü—Ä–æ–π–¥–∏—Ç–µ –≤—Å–µ —à–∞–≥–∏ –¥–æ —Ñ–æ—Ä–º—ã –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤
2. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω (+996700123456)
3. –ù–∞–∂–º–∏—Ç–µ "–°–æ–∑–¥–∞—Ç—å –∑–∞–ø–∏—Å—å"
4. –í Console –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
   ```
   üìù Creating assignment with payload: {...}
   ‚úÖ Assignment created: { id: 123, ... }
   ```
5. –í Network: `POST /booking/assignments`
6. –°—Ç–∞—Ç—É—Å: `200 OK`
7. –î–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å—Å—è Toast: "–ó–∞–ø–∏—Å—å —Å–æ–∑–¥–∞–Ω–∞"

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** ‚¨ú PASS / ‚¨ú FAIL

---

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–≥–æ–≤

–û—Ç–∫—Ä–æ–π—Ç–µ Console –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å:

```
üîë Fetching guest token for organization: 1
‚úÖ Guest token received and saved

üåê API Request: { method: 'GET', url: '.../booking/branches?organizationId=1', ... }

üåê API Request: { method: 'GET', url: '.../booking/staff?branchId=1', ... }

üìù Creating assignment with payload: {
  organizationId: 1,
  branchId: 2,
  client: { firstname: "–ê–Ω–Ω–∞", phoneNumber: "+996700123456" },
  employeeId: 5,
  assignmentDate: "2025-11-27",
  startTime: "14:00",
  endTime: "15:30",
  service: { id: 10, name: "", price: 500, duration: 90 },
  ...
}

‚úÖ Assignment created: { id: 123, ... }
```

---

## ‚ö†Ô∏è –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –û—à–∏–±–∫–∞ "–ù–µ —É–∫–∞–∑–∞–Ω –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ —É–∫–∞–∑–∞–Ω `organisationId` –≤ URL

**–†–µ—à–µ–Ω–∏–µ:** –î–æ–±–∞–≤—å—Ç–µ `?organisationId=1` –∫ URL

---

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "–û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≥–æ—Å—Ç–µ–≤–æ–π —Ç–æ–∫–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `organizationId` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –±–∞–∑–µ
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —ç–Ω–¥–ø–æ–∏–Ω—Ç `/booking/auth/{id}` —Ä–∞–±–æ—Ç–∞–µ—Ç
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Console –¥–ª—è –¥–µ—Ç–∞–ª–µ–π –æ—à–∏–±–∫–∏

---

### –ü—Ä–æ–±–ª–µ–º–∞ 3: 404 –Ω–∞ /booking/* –∑–∞–ø—Ä–æ—Å–∞—Ö

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π `VITE_SECONDARY_BACKEND_URL`

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `.env` —Ñ–∞–π–ª
2. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ URL –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ dev —Å–µ—Ä–≤–µ—Ä

---

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –ü—É—Å—Ç–æ–π —Å–ø–∏—Å–æ–∫ —Ñ–∏–ª–∏–∞–ª–æ–≤/–º–∞—Å—Ç–µ—Ä–æ–≤

**–ü—Ä–∏—á–∏–Ω–∞:** –í –±–∞–∑–µ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —ç—Ç–æ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –µ—Å—Ç—å —Ñ–∏–ª–∏–∞–ª—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —É —Ñ–∏–ª–∏–∞–ª–∞ –µ—Å—Ç—å —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –æ—Ç–≤–µ—Ç –≤ Network tab

---

## üìö –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

–î–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ —á–∏—Ç–∞–π—Ç–µ:

**`docs/BOOKING_API_INTEGRATION.md`**

–¢–∞–º –≤—ã –Ω–∞–π–¥–µ—Ç–µ:
- –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤
- –ü—Ä–∏–º–µ—Ä—ã request/response
- –û–ø–∏—Å–∞–Ω–∏–µ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è booking-service
- –ü–æ–ª–Ω—ã–π —á–µ–∫–ª–∏—Å—Ç –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
- –û–ø–∏—Å–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

---

## üéâ –ì–æ—Ç–æ–≤–æ!

–í—Å–µ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏ –≥–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. ‚úÖ –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –ø–æ —á–µ–∫–ª–∏—Å—Ç—É –≤—ã—à–µ
2. ‚¨ú –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–∞–±–æ—Ç—É –Ω–∞ production URL
3. ‚¨ú –î–æ–±–∞–≤—å—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É edge cases (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)

---

**–î–∞—Ç–∞:** 2025-11-27
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é
